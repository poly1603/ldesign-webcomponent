<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>缩略图导航测试</title>
    <script type="module" src="/build/ldesign.esm.js"></script>
    <script nomodule src="/build/ldesign.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background: #1a1a1a;
            color: white;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
        }
        .demo-box {
            background: #2a2a2a;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .demo-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: #4c9ffe;
        }
        .demo-container {
            height: 500px;
            border: 2px dashed #444;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
            background: #1a1a1a;
        }
        .controls {
            margin-top: 15px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        button {
            padding: 8px 16px;
            background: #4c9ffe;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }
        button:hover {
            background: #6cafff;
        }
        .info {
            margin-top: 10px;
            padding: 10px;
            background: rgba(76, 159, 254, 0.1);
            border-radius: 6px;
            font-size: 14px;
        }
        .tips {
            margin-top: 10px;
            color: #999;
            font-size: 13px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🗺️ 缩略图导航功能测试</h1>

        <!-- 测试1：基础缩略图 -->
        <div class="demo-box">
            <h2 class="demo-title">基础缩略图导航</h2>
            <div class="demo-container">
                <ldesign-draggable 
                    id="demo1"
                    src="https://picsum.photos/id/1049/2000/1500"
                    style="width:100%;height:100%"
                    show-minimap
                    minimap-position="top-right"
                    show-controls
                    show-indicators
                    initial-scale="2"
                ></ldesign-draggable>
            </div>
            <div class="info">
                <strong>功能说明：</strong>
                <ul style="margin: 5px 0 0 20px;">
                    <li>右上角显示缩略图导航</li>
                    <li>蓝色框表示当前视口位置</li>
                    <li>点击缩略图可以快速导航</li>
                    <li>视口框会随着缩放和平移实时更新</li>
                </ul>
            </div>
            <div class="tips">
                💡 提示：试着缩放和拖拽画面，观察缩略图中的视口框变化
            </div>
        </div>

        <!-- 测试2：不同位置的缩略图 -->
        <div class="demo-box">
            <h2 class="demo-title">不同位置的缩略图</h2>
            <div class="demo-container">
                <ldesign-draggable 
                    id="demo2"
                    src="https://picsum.photos/id/1043/1600/1200"
                    style="width:100%;height:100%"
                    show-minimap
                    minimap-position="bottom-left"
                    show-controls
                    controls-position="top-right"
                    initial-scale="1.5"
                ></ldesign-draggable>
            </div>
            <div class="controls">
                <button onclick="changeMinimapPosition('top-left')">左上</button>
                <button onclick="changeMinimapPosition('top-right')">右上</button>
                <button onclick="changeMinimapPosition('bottom-left')">左下</button>
                <button onclick="changeMinimapPosition('bottom-right')">右下</button>
                <button onclick="toggleMinimap()">切换显示</button>
            </div>
        </div>

        <!-- 测试3：大图导航 -->
        <div class="demo-box">
            <h2 class="demo-title">大图精确导航</h2>
            <div class="demo-container">
                <ldesign-draggable 
                    id="demo3"
                    src="https://picsum.photos/id/1050/3000/2000"
                    style="width:100%;height:100%"
                    show-minimap
                    show-indicators
                    show-controls
                    initial-scale="3"
                    enable-grid
                    grid-size="30"
                ></ldesign-draggable>
            </div>
            <div class="controls">
                <button onclick="goToCorner('tl')">↖️ 左上角</button>
                <button onclick="goToCorner('tr')">↗️ 右上角</button>
                <button onclick="goToCorner('center')">🎯 中心</button>
                <button onclick="goToCorner('bl')">↙️ 左下角</button>
                <button onclick="goToCorner('br')">↘️ 右下角</button>
            </div>
            <div class="tips">
                💡 提示：点击缩略图的不同位置可以快速导航到对应区域
            </div>
        </div>
    </div>

    <script>
        // 切换缩略图位置
        function changeMinimapPosition(position) {
            const el = document.getElementById('demo2');
            if (el) {
                el.minimapPosition = position;
            }
        }

        // 切换缩略图显示
        function toggleMinimap() {
            const el = document.getElementById('demo2');
            if (el) {
                el.showMinimap = !el.showMinimap;
            }
        }

        // 导航到角落
        function goToCorner(corner) {
            const el = document.getElementById('demo3');
            if (!el) return;
            
            const state = el.getState();
            let x = 0, y = 0;
            
            // 计算边界
            const maxOffset = 500; // 根据实际图片大小调整
            
            switch(corner) {
                case 'tl':
                    x = -maxOffset;
                    y = -maxOffset;
                    break;
                case 'tr':
                    x = maxOffset;
                    y = -maxOffset;
                    break;
                case 'bl':
                    x = -maxOffset;
                    y = maxOffset;
                    break;
                case 'br':
                    x = maxOffset;
                    y = maxOffset;
                    break;
                case 'center':
                    x = 0;
                    y = 0;
                    break;
            }
            
            el.panTo(x, y);
        }

        // 监听变换事件
        document.addEventListener('DOMContentLoaded', () => {
            const demos = ['demo1', 'demo2', 'demo3'];
            demos.forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    el.addEventListener('ldesignTransformChange', (e) => {
                        console.log(`${id} 变换:`, e.detail);
                    });
                }
            });
        });
    </script>
</body>
</html>