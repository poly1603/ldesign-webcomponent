<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Drawer æ»šåŠ¨æ¡è¡¥å¿æµ‹è¯•</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      line-height: 1.6;
      color: #333;
    }

    /* å›ºå®šå¤´éƒ¨ - ç”¨äºæµ‹è¯•è¡¥å¿ */
    .fixed-header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 60px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      display: flex;
      align-items: center;
      padding: 0 20px;
      z-index: 100;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .fixed-header h1 {
      font-size: 20px;
      font-weight: 600;
    }

    /* ä¸»å†…å®¹åŒºåŸŸ */
    .main-content {
      margin-top: 60px;
      padding: 40px 20px;
      max-width: 1200px;
      margin-left: auto;
      margin-right: auto;
    }

    /* æµ‹è¯•åŒºåŸŸ */
    .test-section {
      background: white;
      border-radius: 8px;
      padding: 30px;
      margin-bottom: 30px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.08);
    }

    .test-section h2 {
      font-size: 24px;
      margin-bottom: 20px;
      color: #667eea;
    }

    .test-section p {
      margin-bottom: 15px;
      color: #666;
    }

    /* æŒ‰é’®æ ·å¼ */
    .btn-group {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }

    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      outline: none;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }

    .btn-success {
      background: linear-gradient(135deg, #56ab2f 0%, #a8e063 100%);
      color: white;
    }

    .btn-success:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(86, 171, 47, 0.4);
    }

    .btn-info {
      background: linear-gradient(135deg, #667eea 0%, #f093fb 100%);
      color: white;
    }

    .btn-info:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }

    /* å›ºå®šå³ä¾§å…ƒç´  - ç”¨äºæµ‹è¯•è¡¥å¿ */
    .fixed-right-panel {
      position: fixed;
      right: 20px;
      top: 100px;
      width: 200px;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.1);
      z-index: 99;
    }

    .fixed-right-panel h3 {
      font-size: 16px;
      margin-bottom: 10px;
      color: #667eea;
    }

    .fixed-right-panel p {
      font-size: 14px;
      color: #666;
      margin-bottom: 15px;
    }

    /* çŠ¶æ€æŒ‡ç¤ºå™¨ */
    .status-indicator {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
      margin-left: 10px;
    }

    .status-locked {
      background: #fee;
      color: #c33;
    }

    .status-unlocked {
      background: #efe;
      color: #3c3;
    }

    /* é•¿å†…å®¹åŒºåŸŸ */
    .long-content {
      height: 200vh;
      background: linear-gradient(180deg, #f8f9fa 0%, #e9ecef 100%);
      padding: 40px;
      border-radius: 8px;
    }

    .long-content h3 {
      margin-bottom: 20px;
      color: #667eea;
    }

    .long-content p {
      margin-bottom: 15px;
      line-height: 1.8;
    }

    /* è°ƒè¯•ä¿¡æ¯ */
    .debug-info {
      position: fixed;
      bottom: 20px;
      left: 20px;
      background: rgba(0,0,0,0.8);
      color: white;
      padding: 15px;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      z-index: 9999;
      max-width: 300px;
    }

    .debug-info h4 {
      margin-bottom: 10px;
      color: #ffd700;
    }

    .debug-info p {
      margin-bottom: 5px;
    }

    .debug-info .value {
      color: #4ade80;
      font-weight: bold;
    }

    /* å“åº”å¼ */
    @media (max-width: 768px) {
      .fixed-right-panel {
        display: none;
      }
      
      .debug-info {
        display: none;
      }
    }
  </style>
</head>
<body>
  <!-- å›ºå®šå¤´éƒ¨ -->
  <header class="fixed-header" data-fixed-compensate>
    <h1>ğŸ¨ Drawer æ»šåŠ¨æ¡è¡¥å¿æµ‹è¯•</h1>
    <span class="status-indicator status-unlocked" id="scrollStatus">æœªé”å®š</span>
  </header>

  <!-- å›ºå®šå³ä¾§é¢æ¿ -->
  <aside class="fixed-right-panel" data-fixed-compensate>
    <h3>ğŸ“Œ å›ºå®šé¢æ¿</h3>
    <p>è¿™ä¸ªé¢æ¿æ˜¯ fixed å®šä½çš„ï¼Œç”¨äºæµ‹è¯•æ»šåŠ¨æ¡è¡¥å¿ã€‚</p>
    <p>æ‰“å¼€ drawer æ—¶ï¼Œè¿™ä¸ªé¢æ¿åº”è¯¥ä¸ä¼šå‘ç”Ÿä½ç§»ã€‚</p>
  </aside>

  <!-- ä¸»å†…å®¹ -->
  <main class="main-content">
    <!-- æµ‹è¯•è¯´æ˜ -->
    <section class="test-section">
      <h2>ğŸ“– æµ‹è¯•è¯´æ˜</h2>
      <p>è¿™ä¸ªé¡µé¢ç”¨äºæµ‹è¯• drawer ç»„ä»¶çš„æ»šåŠ¨æ¡è¡¥å¿åŠŸèƒ½ã€‚</p>
      <p><strong>æµ‹è¯•æ­¥éª¤ï¼š</strong></p>
      <ol style="margin-left: 20px; color: #666;">
        <li>æ³¨æ„è§‚å¯Ÿé¡µé¢ä¸Šçš„å›ºå®šå¤´éƒ¨å’Œå³ä¾§é¢æ¿</li>
        <li>ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ‰“å¼€ drawer</li>
        <li>è§‚å¯Ÿé¡µé¢å†…å®¹æ˜¯å¦å‘ç”ŸæŠ–åŠ¨</li>
        <li>æ£€æŸ¥å›ºå®šå…ƒç´ æ˜¯å¦ä¿æŒä½ç½®</li>
        <li>æŸ¥çœ‹åº•éƒ¨çš„è°ƒè¯•ä¿¡æ¯</li>
      </ol>
    </section>

    <!-- æµ‹è¯•æŒ‰é’® -->
    <section class="test-section">
      <h2>ğŸ¯ æµ‹è¯•ç”¨ä¾‹</h2>
      
      <div class="btn-group">
        <button class="btn btn-primary" onclick="openDrawer('right')">
          æ‰“å¼€å³ä¾§æŠ½å±‰
        </button>
        <button class="btn btn-primary" onclick="openDrawer('left')">
          æ‰“å¼€å·¦ä¾§æŠ½å±‰
        </button>
        <button class="btn btn-primary" onclick="openDrawer('top')">
          æ‰“å¼€é¡¶éƒ¨æŠ½å±‰
        </button>
        <button class="btn btn-primary" onclick="openDrawer('bottom')">
          æ‰“å¼€åº•éƒ¨æŠ½å±‰
        </button>
      </div>

      <div class="btn-group">
        <button class="btn btn-success" onclick="openMultipleDrawers()">
          åŒæ—¶æ‰“å¼€å¤šä¸ªæŠ½å±‰
        </button>
        <button class="btn btn-info" onclick="toggleDrawerQuickly()">
          å¿«é€Ÿåˆ‡æ¢æŠ½å±‰
        </button>
      </div>
    </section>

    <!-- é•¿å†…å®¹åŒºåŸŸ -->
    <section class="long-content">
      <h3>ğŸ“œ é•¿å†…å®¹åŒºåŸŸï¼ˆç”¨äºäº§ç”Ÿæ»šåŠ¨æ¡ï¼‰</h3>
      <p>è¿™æ˜¯ä¸€ä¸ªå¾ˆé•¿çš„å†…å®¹åŒºåŸŸï¼Œç”¨äºç¡®ä¿é¡µé¢æœ‰æ»šåŠ¨æ¡ã€‚åªæœ‰å½“é¡µé¢æœ‰æ»šåŠ¨æ¡æ—¶ï¼Œæ‰èƒ½æµ‹è¯•æ»šåŠ¨æ¡è¡¥å¿åŠŸèƒ½ã€‚</p>
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
      <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
      <p>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.</p>
      <p>æ»šåŠ¨æ¡è¡¥å¿æ˜¯ä¸€ä¸ªå¸¸è§çš„ UI é—®é¢˜ï¼Œå½“æ¨¡æ€æ¡†ã€æŠ½å±‰ç­‰ç»„ä»¶æ‰“å¼€æ—¶ï¼Œä¸ºäº†é˜²æ­¢é¡µé¢æ»šåŠ¨ï¼Œé€šå¸¸ä¼šè®¾ç½® body çš„ overflow ä¸º hiddenã€‚</p>
      <p>ä½†è¿™ä¼šå¯¼è‡´æ»šåŠ¨æ¡æ¶ˆå¤±ï¼Œé¡µé¢å†…å®¹ä¼šå‘å³ç§»åŠ¨ï¼ˆæ»šåŠ¨æ¡çš„å®½åº¦ï¼‰ï¼Œäº§ç”Ÿè§†è§‰ä¸Šçš„è·³åŠ¨ã€‚</p>
      <p>è§£å†³æ–¹æ¡ˆæ˜¯åœ¨éšè—æ»šåŠ¨æ¡çš„åŒæ—¶ï¼Œç»™ body æ·»åŠ ä¸æ»šåŠ¨æ¡å®½åº¦ç›¸ç­‰çš„ padding-rightï¼Œä»¥è¡¥å¿æ»šåŠ¨æ¡æ¶ˆå¤±å¸¦æ¥çš„ä½ç§»ã€‚</p>
      <p>åŒæ—¶ï¼Œéœ€è¦ä¸ºæ‰€æœ‰ fixed å’Œ sticky å®šä½çš„å…ƒç´ ä¹Ÿåšç›¸åŒçš„è¡¥å¿ï¼Œç¡®ä¿å®ƒä»¬çš„ä½ç½®ä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚</p>
    </section>
  </main>

  <!-- è°ƒè¯•ä¿¡æ¯ -->
  <div class="debug-info" id="debugInfo">
    <h4>ğŸ” è°ƒè¯•ä¿¡æ¯</h4>
    <p>æ»šåŠ¨æ¡å®½åº¦: <span class="value" id="scrollbarWidth">-</span></p>
    <p>é”å®šè®¡æ•°: <span class="value" id="lockCount">0</span></p>
    <p>è¡¥å¿å…ƒç´ æ•°: <span class="value" id="compensatedCount">0</span></p>
    <p>Body Padding: <span class="value" id="bodyPadding">-</span></p>
  </div>

  <!-- Drawer ç»„ä»¶ -->
  <ldesign-drawer id="drawer-right" placement="right" drawer-title="å³ä¾§æŠ½å±‰">
    <div style="padding: 20px;">
      <h3>æŠ½å±‰å†…å®¹</h3>
      <p>è¿™æ˜¯å³ä¾§æŠ½å±‰çš„å†…å®¹ã€‚</p>
      <p>æ‰“å¼€æ—¶é¡µé¢åº”è¯¥ä¸ä¼šå‘ç”ŸæŠ–åŠ¨ã€‚</p>
      <button class="btn btn-primary" onclick="closeDrawer('right')">å…³é—­</button>
    </div>
  </ldesign-drawer>

  <ldesign-drawer id="drawer-left" placement="left" drawer-title="å·¦ä¾§æŠ½å±‰">
    <div style="padding: 20px;">
      <h3>æŠ½å±‰å†…å®¹</h3>
      <p>è¿™æ˜¯å·¦ä¾§æŠ½å±‰çš„å†…å®¹ã€‚</p>
      <button class="btn btn-primary" onclick="closeDrawer('left')">å…³é—­</button>
    </div>
  </ldesign-drawer>

  <ldesign-drawer id="drawer-top" placement="top" drawer-title="é¡¶éƒ¨æŠ½å±‰">
    <div style="padding: 20px;">
      <h3>æŠ½å±‰å†…å®¹</h3>
      <p>è¿™æ˜¯é¡¶éƒ¨æŠ½å±‰çš„å†…å®¹ã€‚</p>
      <button class="btn btn-primary" onclick="closeDrawer('top')">å…³é—­</button>
    </div>
  </ldesign-drawer>

  <ldesign-drawer id="drawer-bottom" placement="bottom" drawer-title="åº•éƒ¨æŠ½å±‰">
    <div style="padding: 20px;">
      <h3>æŠ½å±‰å†…å®¹</h3>
      <p>è¿™æ˜¯åº•éƒ¨æŠ½å±‰çš„å†…å®¹ã€‚</p>
      <button class="btn btn-primary" onclick="closeDrawer('bottom')">å…³é—­</button>
    </div>
  </ldesign-drawer>

  <script type="module">
    // å¯¼å…¥ç»„ä»¶ï¼ˆæ ¹æ®ä½ çš„å®é™…è·¯å¾„è°ƒæ•´ï¼‰
    // import '../dist/components/ldesign-drawer.js';
  </script>

  <script>
    // æ‰“å¼€æŠ½å±‰
    async function openDrawer(placement) {
      const drawer = document.getElementById(`drawer-${placement}`);
      if (drawer) {
        await drawer.open();
        updateDebugInfo();
      }
    }

    // å…³é—­æŠ½å±‰
    async function closeDrawer(placement) {
      const drawer = document.getElementById(`drawer-${placement}`);
      if (drawer) {
        await drawer.close();
        updateDebugInfo();
      }
    }

    // åŒæ—¶æ‰“å¼€å¤šä¸ªæŠ½å±‰
    async function openMultipleDrawers() {
      await openDrawer('right');
      setTimeout(() => openDrawer('left'), 500);
      setTimeout(() => openDrawer('bottom'), 1000);
    }

    // å¿«é€Ÿåˆ‡æ¢æŠ½å±‰
    async function toggleDrawerQuickly() {
      for (let i = 0; i < 3; i++) {
        await openDrawer('right');
        await new Promise(resolve => setTimeout(resolve, 300));
        await closeDrawer('right');
        await new Promise(resolve => setTimeout(resolve, 300));
      }
    }

    // æ›´æ–°è°ƒè¯•ä¿¡æ¯
    function updateDebugInfo() {
      const scrollbarWidth = window.innerWidth - document.documentElement.clientWidth;
      const lockCount = document.body.getAttribute('data-scroll-lock-count') || '0';
      const compensatedElements = document.querySelectorAll('[data-scroll-compensated="true"]');
      const bodyPadding = window.getComputedStyle(document.body).paddingRight;

      document.getElementById('scrollbarWidth').textContent = scrollbarWidth + 'px';
      document.getElementById('lockCount').textContent = lockCount;
      document.getElementById('compensatedCount').textContent = compensatedElements.length;
      document.getElementById('bodyPadding').textContent = bodyPadding;

      // æ›´æ–°çŠ¶æ€æŒ‡ç¤ºå™¨
      const statusIndicator = document.getElementById('scrollStatus');
      if (parseInt(lockCount) > 0) {
        statusIndicator.textContent = 'å·²é”å®š';
        statusIndicator.className = 'status-indicator status-locked';
      } else {
        statusIndicator.textContent = 'æœªé”å®š';
        statusIndicator.className = 'status-indicator status-unlocked';
      }
    }

    // å®šæœŸæ›´æ–°è°ƒè¯•ä¿¡æ¯
    setInterval(updateDebugInfo, 500);

    // åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', () => {
      updateDebugInfo();
      console.log('%cæ»šåŠ¨æ¡è¡¥å¿æµ‹è¯•é¡µé¢å·²åŠ è½½', 'color: #667eea; font-weight: bold; font-size: 14px;');
      console.log('æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹æ›´å¤šè°ƒè¯•ä¿¡æ¯');
    });

    // ç›‘å¬ drawer äº‹ä»¶
    document.addEventListener('drawerOpen', (e) => {
      console.log('Drawer opened:', e.detail);
      updateDebugInfo();
    });

    document.addEventListener('drawerClose', (e) => {
      console.log('Drawer closed:', e.detail);
      updateDebugInfo();
    });
  </script>
</body>
</html>
