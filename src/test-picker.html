<!DOCTYPE html>
<html dir="ltr" lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0, user-scalable=no" />
  <title>Picker ç»„ä»¶æµ‹è¯• - æ©¡çš®ç­‹æ•ˆæœ</title>

  <script type="module" src="/build/ldesign-webcomponent.esm.js"></script>
  <script nomodule src="/build/ldesign-webcomponent.js"></script>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'Helvetica Neue', Helvetica, Arial, sans-serif;
      background-color: #f5f5f5;
      padding: 20px;
    }
    
    .container {
      max-width: 500px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
    }
    
    h1 {
      text-align: center;
      color: #333;
      margin-bottom: 10px;
      font-size: 24px;
    }
    
    .description {
      text-align: center;
      color: #666;
      margin-bottom: 30px;
      font-size: 14px;
      line-height: 1.6;
    }
    
    .test-section {
      margin-bottom: 40px;
      padding-bottom: 20px;
      border-bottom: 1px solid #eee;
    }
    
    .test-section:last-child {
      border-bottom: none;
    }
    
    .test-title {
      font-size: 18px;
      color: #444;
      margin-bottom: 15px;
      font-weight: 600;
    }
    
    .test-desc {
      font-size: 14px;
      color: #888;
      margin-bottom: 20px;
      background: #f8f9fa;
      padding: 10px;
      border-radius: 6px;
    }
    
    .picker-container {
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      overflow: hidden;
      margin-bottom: 15px;
    }
    
    .result-display {
      background: #f0f8ff;
      padding: 10px;
      border-radius: 6px;
      font-size: 14px;
      color: #333;
      margin-top: 10px;
    }
    
    .button-group {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
    }
    
    button {
      padding: 8px 16px;
      background: #722ED1;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      transition: background 0.3s;
    }
    
    button:hover {
      background: #5a23a8;
    }
    
    button:active {
      transform: scale(0.98);
    }
    
    .debug-info {
      background: #2d3748;
      color: #63b3ed;
      padding: 10px;
      border-radius: 6px;
      font-family: 'Monaco', 'Menlo', monospace;
      font-size: 12px;
      margin-top: 10px;
      max-height: 200px;
      overflow-y: auto;
    }
    
    .debug-info.hidden {
      display: none;
    }
    
    .toggle-debug {
      background: #48bb78;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ¯ Picker ç»„ä»¶æµ‹è¯•</h1>
    <div class="description">
      æµ‹è¯•æ©¡çš®ç­‹æ•ˆæœï¼šåœ¨åˆ—è¡¨è¾¹ç•Œç»§ç»­æ‹–æ‹½æ—¶ï¼Œåº”è¯¥æœ‰å¹³æ»‘çš„é˜»åŠ›æ•ˆæœï¼Œä¸åº”å‡ºç°æŠ–åŠ¨
    </div>

    <!-- æµ‹è¯•1: åŸºç¡€å•åˆ—é€‰æ‹©å™¨ -->
    <div class="test-section">
      <h2 class="test-title">ğŸ“‹ åŸºç¡€å•åˆ—é€‰æ‹©å™¨</h2>
      <div class="test-desc">
        æµ‹è¯•è¦ç‚¹ï¼š<br>
        1. æ‹–æ‹½åˆ°ç¬¬ä¸€ä¸ªé€‰é¡¹åç»§ç»­å‘ä¸‹æ‹‰ï¼Œæ£€æŸ¥æ©¡çš®ç­‹æ•ˆæœ<br>
        2. æ‹–æ‹½åˆ°æœ€åä¸€ä¸ªé€‰é¡¹åç»§ç»­å‘ä¸Šæ‹‰ï¼Œæ£€æŸ¥æ©¡çš®ç­‹æ•ˆæœ<br>
        3. å¿«é€Ÿæ‹–æ‹½æ—¶æ˜¯å¦å¹³æ»‘ï¼Œæœ‰æ— æŠ–åŠ¨
      </div>
      
      <div class="picker-container">
        <ldesign-picker id="picker1"></ldesign-picker>
      </div>
      
      <div class="button-group">
        <button onclick="scrollToFirst('picker1')">æ»šåŠ¨åˆ°ç¬¬ä¸€é¡¹</button>
        <button onclick="scrollToLast('picker1')">æ»šåŠ¨åˆ°æœ€åä¸€é¡¹</button>
        <button onclick="scrollToMiddle('picker1')">æ»šåŠ¨åˆ°ä¸­é—´</button>
      </div>
      
      <div class="result-display" id="result1">
        å½“å‰é€‰ä¸­: <span id="value1">-</span>
      </div>
      
      <button class="toggle-debug" onclick="toggleDebug('debug1')">æ˜¾ç¤º/éšè—è°ƒè¯•ä¿¡æ¯</button>
      <div class="debug-info hidden" id="debug1"></div>
    </div>

    <!-- æµ‹è¯•2: å¤šåˆ—è”åŠ¨é€‰æ‹©å™¨ -->
    <div class="test-section">
      <h2 class="test-title">ğŸ”— å¤šåˆ—è”åŠ¨é€‰æ‹©å™¨</h2>
      <div class="test-desc">
        æµ‹è¯•è¦ç‚¹ï¼š<br>
        1. æ¯ä¸€åˆ—éƒ½æµ‹è¯•è¾¹ç•Œæ©¡çš®ç­‹æ•ˆæœ<br>
        2. è”åŠ¨æ—¶æ£€æŸ¥æ–°åˆ—çš„æ©¡çš®ç­‹æ˜¯å¦æ­£å¸¸<br>
        3. åˆ—åˆ‡æ¢æ—¶çŠ¶æ€æ˜¯å¦æ­£ç¡®é‡ç½®
      </div>
      
      <div class="picker-container">
        <ldesign-picker id="picker2"></ldesign-picker>
      </div>
      
      <div class="result-display" id="result2">
        å½“å‰é€‰ä¸­: <span id="value2">-</span>
      </div>
      
      <button class="toggle-debug" onclick="toggleDebug('debug2')">æ˜¾ç¤º/éšè—è°ƒè¯•ä¿¡æ¯</button>
      <div class="debug-info hidden" id="debug2"></div>
    </div>

    <!-- æµ‹è¯•3: å°‘é‡é€‰é¡¹æµ‹è¯• -->
    <div class="test-section">
      <h2 class="test-title">ğŸ“‰ å°‘é‡é€‰é¡¹æµ‹è¯•</h2>
      <div class="test-desc">
        æµ‹è¯•è¦ç‚¹ï¼š<br>
        1. åªæœ‰ 2-3 ä¸ªé€‰é¡¹æ—¶çš„æ©¡çš®ç­‹æ•ˆæœ<br>
        2. é€‰é¡¹ä¸è¶³ä»¥å¡«æ»¡è§†å£æ—¶çš„è¾¹ç•Œå¤„ç†
      </div>
      
      <div class="picker-container">
        <ldesign-picker id="picker3"></ldesign-picker>
      </div>
      
      <div class="result-display" id="result3">
        å½“å‰é€‰ä¸­: <span id="value3">-</span>
      </div>
      
      <button class="toggle-debug" onclick="toggleDebug('debug3')">æ˜¾ç¤º/éšè—è°ƒè¯•ä¿¡æ¯</button>
      <div class="debug-info hidden" id="debug3"></div>
    </div>

    <!-- æµ‹è¯•4: å¤§é‡é€‰é¡¹æ€§èƒ½æµ‹è¯• -->
    <div class="test-section">
      <h2 class="test-title">ğŸš€ å¤§é‡é€‰é¡¹æ€§èƒ½æµ‹è¯•</h2>
      <div class="test-desc">
        æµ‹è¯•è¦ç‚¹ï¼š<br>
        1. 100+ é€‰é¡¹æ—¶çš„æ»šåŠ¨æ€§èƒ½<br>
        2. å¿«é€Ÿæ‹–æ‹½æ—¶æ©¡çš®ç­‹æ˜¯å¦æµç•…<br>
        3. æƒ¯æ€§æ»šåŠ¨ä¸æ©¡çš®ç­‹çš„é…åˆ
      </div>
      
      <div class="picker-container">
        <ldesign-picker id="picker4"></ldesign-picker>
      </div>
      
      <div class="result-display" id="result4">
        å½“å‰é€‰ä¸­: <span id="value4">-</span>
      </div>
      
      <button class="toggle-debug" onclick="toggleDebug('debug4')">æ˜¾ç¤º/éšè—è°ƒè¯•ä¿¡æ¯</button>
      <div class="debug-info hidden" id="debug4"></div>
    </div>
  </div>

  <script>
    // è°ƒè¯•æ—¥å¿—æ”¶é›†å™¨
    const debugLogs = {
      picker1: [],
      picker2: [],
      picker3: [],
      picker4: []
    };

    // è®°å½•è°ƒè¯•ä¿¡æ¯
    function logDebug(pickerId, message) {
      const timestamp = new Date().toLocaleTimeString('zh-CN', { hour12: false, milliseconds: true });
      debugLogs[pickerId].push(`[${timestamp}] ${message}`);
      
      // ä¿æŒæœ€è¿‘50æ¡
      if (debugLogs[pickerId].length > 50) {
        debugLogs[pickerId].shift();
      }
      
      // æ›´æ–°æ˜¾ç¤º
      const debugEl = document.getElementById(pickerId.replace('picker', 'debug'));
      if (debugEl && !debugEl.classList.contains('hidden')) {
        debugEl.innerHTML = debugLogs[pickerId].join('<br>');
        debugEl.scrollTop = debugEl.scrollHeight;
      }
    }

    // åˆ‡æ¢è°ƒè¯•ä¿¡æ¯æ˜¾ç¤º
    function toggleDebug(debugId) {
      const debugEl = document.getElementById(debugId);
      debugEl.classList.toggle('hidden');
    }

    // æ»šåŠ¨åˆ°ç¬¬ä¸€é¡¹
    function scrollToFirst(pickerId) {
      const picker = document.getElementById(pickerId);
      if (picker && picker.scrollTo) {
        picker.scrollTo(0, 0);
        logDebug(pickerId, 'æ»šåŠ¨åˆ°ç¬¬ä¸€é¡¹');
      }
    }

    // æ»šåŠ¨åˆ°æœ€åä¸€é¡¹
    function scrollToLast(pickerId) {
      const picker = document.getElementById(pickerId);
      if (picker && picker.scrollTo) {
        const lastIndex = picker.options[0]?.length - 1 || 0;
        picker.scrollTo(0, lastIndex);
        logDebug(pickerId, `æ»šåŠ¨åˆ°æœ€åä¸€é¡¹ (index: ${lastIndex})`);
      }
    }

    // æ»šåŠ¨åˆ°ä¸­é—´
    function scrollToMiddle(pickerId) {
      const picker = document.getElementById(pickerId);
      if (picker && picker.scrollTo) {
        const middleIndex = Math.floor((picker.options[0]?.length - 1) / 2) || 0;
        picker.scrollTo(0, middleIndex);
        logDebug(pickerId, `æ»šåŠ¨åˆ°ä¸­é—´é¡¹ (index: ${middleIndex})`);
      }
    }

    // åˆå§‹åŒ–é€‰æ‹©å™¨
    document.addEventListener('DOMContentLoaded', () => {
      // Picker 1: åŸºç¡€å•åˆ—ï¼ˆæœˆä»½ï¼‰
      const picker1 = document.getElementById('picker1');
      picker1.options = [
        [
          { label: '1æœˆ', value: '1' },
          { label: '2æœˆ', value: '2' },
          { label: '3æœˆ', value: '3' },
          { label: '4æœˆ', value: '4' },
          { label: '5æœˆ', value: '5' },
          { label: '6æœˆ', value: '6' },
          { label: '7æœˆ', value: '7' },
          { label: '8æœˆ', value: '8' },
          { label: '9æœˆ', value: '9' },
          { label: '10æœˆ', value: '10' },
          { label: '11æœˆ', value: '11' },
          { label: '12æœˆ', value: '12' }
        ]
      ];
      picker1.value = ['6'];

      // Picker 2: å¤šåˆ—è”åŠ¨ï¼ˆåœ°åŒºé€‰æ‹©ï¼‰
      const picker2 = document.getElementById('picker2');
      const provinces = [
        { label: 'åŒ—äº¬', value: 'beijing' },
        { label: 'ä¸Šæµ·', value: 'shanghai' },
        { label: 'å¹¿ä¸œ', value: 'guangdong' },
        { label: 'æµ™æ±Ÿ', value: 'zhejiang' }
      ];
      
      const cities = {
        beijing: [
          { label: 'åŒ—äº¬å¸‚', value: 'beijing_city' }
        ],
        shanghai: [
          { label: 'ä¸Šæµ·å¸‚', value: 'shanghai_city' }
        ],
        guangdong: [
          { label: 'å¹¿å·å¸‚', value: 'guangzhou' },
          { label: 'æ·±åœ³å¸‚', value: 'shenzhen' },
          { label: 'ç æµ·å¸‚', value: 'zhuhai' }
        ],
        zhejiang: [
          { label: 'æ­å·å¸‚', value: 'hangzhou' },
          { label: 'å®æ³¢å¸‚', value: 'ningbo' },
          { label: 'æ¸©å·å¸‚', value: 'wenzhou' }
        ]
      };
      
      picker2.options = [provinces, cities.beijing];
      picker2.value = ['beijing', 'beijing_city'];
      
      // è”åŠ¨é€»è¾‘
      picker2.addEventListener('ldesignChange', (e) => {
        const values = e.detail.value;
        const province = values[0];
        
        if (province && cities[province]) {
          const currentOptions = [...picker2.options];
          currentOptions[1] = cities[province];
          picker2.options = currentOptions;
          
          // æ›´æ–°ç¬¬äºŒåˆ—çš„å€¼
          const newValues = [...values];
          newValues[1] = cities[province][0].value;
          picker2.value = newValues;
        }
      });

      // Picker 3: å°‘é‡é€‰é¡¹
      const picker3 = document.getElementById('picker3');
      picker3.options = [
        [
          { label: 'é€‰é¡¹ A', value: 'a' },
          { label: 'é€‰é¡¹ B', value: 'b' },
          { label: 'é€‰é¡¹ C', value: 'c' }
        ]
      ];
      picker3.value = ['b'];

      // Picker 4: å¤§é‡é€‰é¡¹
      const picker4 = document.getElementById('picker4');
      const largeOptions = [];
      for (let i = 1; i <= 100; i++) {
        largeOptions.push({ 
          label: `é€‰é¡¹ ${i}`, 
          value: `option_${i}` 
        });
      }
      picker4.options = [largeOptions];
      picker4.value = ['option_50'];

      // ç›‘å¬æ‰€æœ‰ picker çš„å˜åŒ–äº‹ä»¶
      ['picker1', 'picker2', 'picker3', 'picker4'].forEach(pickerId => {
        const picker = document.getElementById(pickerId);
        const resultSpan = document.getElementById(pickerId.replace('picker', 'value'));
        
        picker.addEventListener('ldesignChange', (e) => {
          const values = e.detail.value;
          resultSpan.textContent = JSON.stringify(values);
          logDebug(pickerId, `å€¼å˜æ›´: ${JSON.stringify(values)}`);
        });
        
        // ç›‘å¬æ»šåŠ¨äº‹ä»¶ï¼ˆå¦‚æœç»„ä»¶æ”¯æŒï¼‰
        picker.addEventListener('ldesignScroll', (e) => {
          logDebug(pickerId, `æ»šåŠ¨: column=${e.detail.column || 0}, offset=${e.detail.offset || 0}`);
        });
        
        // ç›‘å¬æ‹–æ‹½å¼€å§‹/ç»“æŸï¼ˆå¦‚æœç»„ä»¶æ”¯æŒï¼‰
        picker.addEventListener('ldesignDragStart', () => {
          logDebug(pickerId, 'å¼€å§‹æ‹–æ‹½');
        });
        
        picker.addEventListener('ldesignDragEnd', () => {
          logDebug(pickerId, 'æ‹–æ‹½ç»“æŸ');
        });
      });

      // æ€§èƒ½ç›‘æ§
      let frameCount = 0;
      let lastTime = performance.now();
      
      function measureFPS() {
        frameCount++;
        const currentTime = performance.now();
        
        if (currentTime >= lastTime + 1000) {
          const fps = Math.round((frameCount * 1000) / (currentTime - lastTime));
          console.log(`FPS: ${fps}`);
          frameCount = 0;
          lastTime = currentTime;
        }
        
        requestAnimationFrame(measureFPS);
      }
      
      // å¼€å§‹ç›‘æ§FPSï¼ˆå¯é€‰ï¼‰
      // measureFPS();
    });
  </script>
</body>
</html>