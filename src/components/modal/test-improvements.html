<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Modal 组件改进测试 - 按钮规范化与移动端支持</title>
    <script type="module" src="../../dist/ldesign-webcomponent/ldesign-webcomponent.esm.js"></script>
    <link rel="stylesheet" href="../../dist/ldesign-webcomponent/ldesign-webcomponent.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        h1 {
            color: white;
            text-align: center;
            margin-bottom: 30px;
            font-size: 24px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .test-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        
        .test-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        .test-card h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .test-card p {
            color: #666;
            margin-bottom: 15px;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
            display: inline-block;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(102, 126, 234, 0.4);
        }
        
        .btn-primary:active {
            transform: translateY(0);
        }
        
        .device-info {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }
        
        .device-info h2 {
            color: #333;
            font-size: 16px;
            margin-bottom: 10px;
        }
        
        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
            color: #666;
            font-size: 14px;
        }
        
        .badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .badge-success {
            background: #d4edda;
            color: #155724;
        }
        
        .badge-warning {
            background: #fff3cd;
            color: #856404;
        }
        
        .badge-info {
            background: #d1ecf1;
            color: #0c5460;
        }
        
        /* 自定义 Modal 样式变量测试 */
        .custom-style-modal {
            --ld-modal-header-action-gap: 16px;
            --ld-modal-header-btn-size: 40px;
            --ld-modal-header-btn-radius: 8px;
            --ld-modal-footer-btn-gap: 20px;
            --ld-modal-resize-handle-hover-bg: rgba(124, 58, 237, 0.3);
        }
        
        .instructions {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .instructions h3 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .instructions ul {
            color: #666;
            margin-left: 20px;
            line-height: 1.8;
        }
        
        .instructions li {
            margin-bottom: 5px;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 15px;
            }
            
            h1 {
                font-size: 20px;
            }
            
            .test-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🎨 Modal 组件改进测试</h1>
        
        <!-- 设备信息 -->
        <div class="device-info">
            <h2>📱 设备信息</h2>
            <div class="info-row">
                <span>设备类型：</span>
                <span id="deviceType" class="badge"></span>
            </div>
            <div class="info-row">
                <span>触摸支持：</span>
                <span id="touchSupport" class="badge"></span>
            </div>
            <div class="info-row">
                <span>屏幕尺寸：</span>
                <span id="screenSize"></span>
            </div>
            <div class="info-row">
                <span>指针类型：</span>
                <span id="pointerType" class="badge"></span>
            </div>
        </div>
        
        <!-- 测试卡片 -->
        <div class="test-grid">
            <div class="test-card">
                <h3>
                    <span>🎯</span>
                    标准样式测试
                </h3>
                <p>测试优化后的按钮间隔和样式规范。观察头部关闭、最大化按钮的间隔，以及底部按钮组的间隔。</p>
                <button class="btn-primary" onclick="openStandardModal()">打开标准模态框</button>
            </div>
            
            <div class="test-card">
                <h3>
                    <span>✋</span>
                    拖拽功能测试
                </h3>
                <p>测试鼠标和触摸拖拽功能。在移动设备上使用手指拖动标题栏移动窗口。</p>
                <button class="btn-primary" onclick="openDraggableModal()">打开可拖拽模态框</button>
            </div>
            
            <div class="test-card">
                <h3>
                    <span>📐</span>
                    调整大小测试
                </h3>
                <p>测试鼠标和触摸调整大小功能。在移动设备上，触摸并拖动边缘或角落调整窗口大小。</p>
                <button class="btn-primary" onclick="openResizableModal()">打开可调整大小模态框</button>
            </div>
            
            <div class="test-card">
                <h3>
                    <span>🚀</span>
                    完整功能测试
                </h3>
                <p>同时启用拖拽、调整大小和最大化功能，全面测试移动端兼容性。</p>
                <button class="btn-primary" onclick="openFullFeatureModal()">打开全功能模态框</button>
            </div>
            
            <div class="test-card">
                <h3>
                    <span>🎨</span>
                    自定义样式测试
                </h3>
                <p>使用 CSS 变量自定义按钮尺寸、间隔等样式，验证样式系统的灵活性。</p>
                <button class="btn-primary" onclick="openCustomStyleModal()">打开自定义样式模态框</button>
            </div>
            
            <div class="test-card">
                <h3>
                    <span>📱</span>
                    响应式测试
                </h3>
                <p>测试不同屏幕尺寸下的自适应表现，包括移动端优化的触摸区域。</p>
                <button class="btn-primary" onclick="openResponsiveModal()">打开响应式模态框</button>
            </div>
        </div>
        
        <!-- 使用说明 -->
        <div class="instructions">
            <h3>📖 测试说明</h3>
            <ul>
                <li><strong>按钮间隔规范：</strong>头部按钮间隔默认 12px，底部按钮间隔默认 16px</li>
                <li><strong>按钮样式规范：</strong>统一尺寸 36px，圆角 6px，hover 和 active 状态优化</li>
                <li><strong>移动端拖拽：</strong>触摸标题栏并拖动即可移动窗口，按钮区域不会触发拖拽</li>
                <li><strong>移动端按钮：</strong>关闭和最大化按钮在拖拽模式下依然可正常点击</li>
                <li><strong>移动端调整大小：</strong>触摸边缘或角落的调整手柄并拖动</li>
                <li><strong>触摸区域优化：</strong>移动端自动增大调整手柄的触摸区域</li>
                <li><strong>视觉反馈：</strong>移动端显示调整手柄的视觉指示器</li>
            </ul>
        </div>
    </div>
    
    <!-- Modal 定义 -->
    <ldesign-modal id="standardModal" 
                   modal-title="标准样式测试" 
                   closable="true"
                   maximizable="true">
        <div style="padding: 20px;">
            <h4 style="margin-bottom: 15px;">✨ 样式改进展示</h4>
            <p style="line-height: 1.6; color: #666;">
                这个模态框展示了优化后的按钮样式和间隔规范：
            </p>
            <ul style="margin: 15px 0; color: #666; line-height: 1.8;">
                <li>头部关闭和最大化按钮间隔：12px</li>
                <li>按钮统一尺寸：36x36px</li>
                <li>按钮圆角：6px</li>
                <li>底部操作按钮间隔：16px</li>
                <li>hover 效果：背景色变化 + 边框显示</li>
                <li>active 效果：缩放动画</li>
                <li>focus 效果：品牌色轮廓</li>
            </ul>
            <p style="line-height: 1.6; color: #666;">
                请尝试将鼠标悬停在头部按钮上，观察样式变化。
            </p>
        </div>
    </ldesign-modal>
    
    <ldesign-modal id="draggableModal" 
                   modal-title="可拖拽模态框" 
                   is-draggable="true"
                   closable="true"
                   maximizable="true">
        <div style="padding: 20px;">
            <h4 style="margin-bottom: 15px;">🖐️ 拖拽功能测试</h4>
            <p style="line-height: 1.6; color: #666;">
                <strong>桌面端：</strong>使用鼠标点击标题栏并拖动
            </p>
            <p style="line-height: 1.6; color: #666;">
                <strong>移动端：</strong>使用手指触摸标题栏并拖动
            </p>
            <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-top: 15px;">
                <p style="color: #1565c0; margin: 0; font-weight: 500;">
                    ✅ 关闭和最大化按钮在拖拽模式下仍然可以正常点击
                </p>
                <p style="color: #1565c0; margin: 10px 0 0 0; font-size: 14px;">
                    移动端使用触摸事件优化，按钮区域不会触发拖拽
                </p>
            </div>
            <div style="background: #f0f0f0; padding: 15px; border-radius: 8px; margin-top: 10px;">
                <p style="color: #333; margin: 0;">
                    💡 提示：标题栏在可拖拽模式下会显示手型光标
                </p>
            </div>
        </div>
    </ldesign-modal>
    
    <ldesign-modal id="resizableModal" 
                   modal-title="可调整大小模态框" 
                   resizable="true"
                   closable="true"
                   centered="true">
        <div style="padding: 20px;">
            <h4 style="margin-bottom: 15px;">📏 调整大小功能测试</h4>
            <p style="line-height: 1.6; color: #666;">
                <strong>调整方法：</strong>
            </p>
            <ul style="margin: 15px 0; color: #666; line-height: 1.8;">
                <li>拖动四个边缘调整单向尺寸</li>
                <li>拖动四个角落调整双向尺寸</li>
                <li>移动端触摸手柄区域会显示视觉指示器</li>
                <li>移动端手柄触摸区域已优化扩大</li>
            </ul>
            <div style="background: #e8f5e9; padding: 15px; border-radius: 8px; margin-top: 15px;">
                <p style="color: #2e7d32; margin: 0;">
                    ✅ 支持鼠标和触摸操作
                </p>
            </div>
        </div>
    </ldesign-modal>
    
    <ldesign-modal id="fullFeatureModal" 
                   modal-title="全功能模态框" 
                   is-draggable="true"
                   resizable="true"
                   maximizable="true"
                   closable="true">
        <div style="padding: 20px;">
            <h4 style="margin-bottom: 15px;">🎯 完整功能展示</h4>
            <div style="display: grid; gap: 15px;">
                <div style="background: #f5f5f5; padding: 15px; border-radius: 8px;">
                    <h5 style="color: #333; margin-bottom: 10px;">可拖拽</h5>
                    <p style="color: #666; margin: 0; font-size: 14px;">
                        点击/触摸标题栏拖动窗口
                    </p>
                </div>
                <div style="background: #f5f5f5; padding: 15px; border-radius: 8px;">
                    <h5 style="color: #333; margin-bottom: 10px;">可调整大小</h5>
                    <p style="color: #666; margin: 0; font-size: 14px;">
                        拖动边缘和角落调整尺寸
                    </p>
                </div>
                <div style="background: #f5f5f5; padding: 15px; border-radius: 8px;">
                    <h5 style="color: #333; margin-bottom: 10px;">可最大化</h5>
                    <p style="color: #666; margin: 0; font-size: 14px;">
                        点击最大化按钮全屏显示
                    </p>
                </div>
            </div>
            <p style="margin-top: 20px; padding: 15px; background: #fff3cd; border-radius: 8px; color: #856404;">
                ⚡ 所有功能均支持移动端触摸操作
            </p>
        </div>
    </ldesign-modal>
    
    <ldesign-modal id="customStyleModal" 
                   modal-title="自定义样式模态框" 
                   class="custom-style-modal"
                   closable="true"
                   maximizable="true"
                   resizable="true">
        <div style="padding: 20px;">
            <h4 style="margin-bottom: 15px;">🎨 自定义样式展示</h4>
            <p style="line-height: 1.6; color: #666;">
                通过 CSS 变量自定义的样式：
            </p>
            <pre style="background: #f5f5f5; padding: 15px; border-radius: 8px; overflow-x: auto;">
--ld-modal-header-action-gap: 16px;
--ld-modal-header-btn-size: 40px;
--ld-modal-header-btn-radius: 8px;
--ld-modal-footer-btn-gap: 20px;</pre>
            <p style="line-height: 1.6; color: #666; margin-top: 15px;">
                观察头部按钮和底部按钮的样式变化。
            </p>
        </div>
    </ldesign-modal>
    
    <ldesign-modal id="responsiveModal" 
                   modal-title="响应式模态框" 
                   resizable="true"
                   closable="true">
        <div style="padding: 20px;">
            <h4 style="margin-bottom: 15px;">📱 响应式设计</h4>
            <p style="line-height: 1.6; color: #666;">
                当前视口宽度：<span id="viewportWidth" style="font-weight: bold;"></span>
            </p>
            <p style="line-height: 1.6; color: #666;">
                当前视口高度：<span id="viewportHeight" style="font-weight: bold;"></span>
            </p>
            <div id="responsiveInfo" style="margin-top: 20px; padding: 15px; background: #f5f5f5; border-radius: 8px;">
                <!-- 动态内容 -->
            </div>
        </div>
    </ldesign-modal>
    
    <script>
        // 设备信息检测
        function detectDevice() {
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            const isTablet = /iPad|Android/i.test(navigator.userAgent) && !(/Mobile/i.test(navigator.userAgent));
            const hasTouch = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
            const pointerCoarse = window.matchMedia('(pointer: coarse)').matches;
            
            // 更新设备信息显示
            const deviceType = document.getElementById('deviceType');
            const touchSupport = document.getElementById('touchSupport');
            const screenSize = document.getElementById('screenSize');
            const pointerType = document.getElementById('pointerType');
            
            if (isMobile) {
                deviceType.textContent = '移动设备';
                deviceType.className = 'badge badge-info';
            } else if (isTablet) {
                deviceType.textContent = '平板设备';
                deviceType.className = 'badge badge-info';
            } else {
                deviceType.textContent = '桌面设备';
                deviceType.className = 'badge badge-success';
            }
            
            if (hasTouch) {
                touchSupport.textContent = '支持';
                touchSupport.className = 'badge badge-success';
            } else {
                touchSupport.textContent = '不支持';
                touchSupport.className = 'badge badge-warning';
            }
            
            screenSize.textContent = `${window.innerWidth} × ${window.innerHeight}`;
            
            if (pointerCoarse) {
                pointerType.textContent = '粗略（触摸）';
                pointerType.className = 'badge badge-info';
            } else {
                pointerType.textContent = '精确（鼠标）';
                pointerType.className = 'badge badge-success';
            }
        }
        
        // 打开各种模态框
        function openStandardModal() {
            document.getElementById('standardModal').visible = true;
        }
        
        function openDraggableModal() {
            document.getElementById('draggableModal').visible = true;
        }
        
        function openResizableModal() {
            document.getElementById('resizableModal').visible = true;
        }
        
        function openFullFeatureModal() {
            document.getElementById('fullFeatureModal').visible = true;
        }
        
        function openCustomStyleModal() {
            document.getElementById('customStyleModal').visible = true;
        }
        
        function openResponsiveModal() {
            const modal = document.getElementById('responsiveModal');
            updateResponsiveInfo();
            modal.visible = true;
        }
        
        // 更新响应式信息
        function updateResponsiveInfo() {
            document.getElementById('viewportWidth').textContent = window.innerWidth + 'px';
            document.getElementById('viewportHeight').textContent = window.innerHeight + 'px';
            
            const info = document.getElementById('responsiveInfo');
            const width = window.innerWidth;
            let breakpoint = '';
            
            if (width < 480) {
                breakpoint = 'XS (< 480px) - 超小屏幕';
            } else if (width < 768) {
                breakpoint = 'SM (480px - 768px) - 小屏幕';
            } else if (width < 1024) {
                breakpoint = 'MD (768px - 1024px) - 中等屏幕';
            } else if (width < 1280) {
                breakpoint = 'LG (1024px - 1280px) - 大屏幕';
            } else {
                breakpoint = 'XL (> 1280px) - 超大屏幕';
            }
            
            info.innerHTML = `
                <p style="margin: 0; color: #333;">
                    <strong>当前断点：</strong>${breakpoint}
                </p>
                <p style="margin: 10px 0 0 0; color: #666; font-size: 14px;">
                    在不同断点下，模态框会自动调整布局和间距。
                </p>
            `;
        }
        
        // 监听窗口大小变化
        window.addEventListener('resize', () => {
            detectDevice();
            if (document.getElementById('responsiveModal').visible) {
                updateResponsiveInfo();
            }
        });
        
        // 页面加载时检测设备
        document.addEventListener('DOMContentLoaded', () => {
            detectDevice();
            
            // 为所有模态框添加事件监听
            document.querySelectorAll('ldesign-modal').forEach(modal => {
                modal.addEventListener('ldesignVisibleChange', (e) => {
                    console.log(`Modal ${modal.id} visible:`, e.detail);
                });
            });
        });
        
        // 添加触摸事件调试信息（开发时使用）
        if (window.location.hash === '#debug') {
            let touchLog = [];
            document.addEventListener('touchstart', (e) => {
                console.log('Touch start:', e.touches[0]);
                touchLog.push({type: 'start', x: e.touches[0].clientX, y: e.touches[0].clientY});
            });
            document.addEventListener('touchmove', (e) => {
                console.log('Touch move:', e.touches[0]);
            });
            document.addEventListener('touchend', (e) => {
                console.log('Touch end');
                touchLog.push({type: 'end'});
                console.log('Touch sequence:', touchLog);
                touchLog = [];
            });
        }
    </script>
</body>
</html>