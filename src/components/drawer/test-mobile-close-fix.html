<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>ç§»åŠ¨ç«¯å…³é—­æŒ‰é’®ä¿®å¤æµ‹è¯•</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            font-size: 24px;
            margin-bottom: 10px;
            color: #333;
        }
        
        .subtitle {
            color: #666;
            margin-bottom: 20px;
            font-size: 14px;
        }
        
        .test-section {
            margin-bottom: 25px;
            padding: 15px;
            background: #f5f5f5;
            border-radius: 8px;
        }
        
        .test-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 10px;
            color: #444;
        }
        
        .test-description {
            font-size: 14px;
            color: #666;
            margin-bottom: 12px;
            line-height: 1.5;
        }
        
        .btn {
            display: inline-block;
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: transform 0.2s;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            margin: 5px;
        }
        
        .btn:active {
            transform: scale(0.95);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #fa709a, #fee140);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ff6b6b, #ee5a6f);
        }
        
        .status {
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
            font-size: 13px;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .event-log {
            margin-top: 15px;
            padding: 10px;
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 6px;
            max-height: 200px;
            overflow-y: auto;
            font-size: 12px;
            font-family: 'Courier New', monospace;
        }
        
        .event-log-item {
            padding: 4px 0;
            border-bottom: 1px solid #eee;
        }
        
        .event-log-item:last-child {
            border-bottom: none;
        }
        
        .timestamp {
            color: #999;
            margin-right: 8px;
        }
        
        .drawer-content {
            padding: 20px;
        }
        
        .drawer-content h3 {
            margin-bottom: 10px;
            color: #333;
        }
        
        .drawer-content p {
            line-height: 1.6;
            color: #666;
            margin-bottom: 10px;
        }
        
        .close-test-area {
            margin-top: 20px;
            padding: 15px;
            background: #e3f2fd;
            border-radius: 8px;
            border: 2px dashed #2196f3;
        }
        
        .close-test-area h4 {
            color: #1976d2;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .close-instruction {
            color: #0d47a1;
            font-size: 14px;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ ç§»åŠ¨ç«¯ Drawer ä¿®å¤æµ‹è¯•</h1>
        <p class="subtitle">æµ‹è¯•å…³é—­æŒ‰é’®ç‚¹å‡» & è¶…å‡ºå±å¹•ä¿®å¤</p>
        
        <div class="test-section">
            <div class="test-title">ğŸ“± è®¾å¤‡ä¿¡æ¯</div>
            <div id="device-info" class="status info">
                <div>å±å¹•å®½åº¦: <span id="screen-width"></span>px</div>
                <div>å±å¹•é«˜åº¦: <span id="screen-height"></span>px</div>
                <div>è®¾å¤‡ç±»å‹: <span id="device-type"></span></div>
            </div>
        </div>
        
        <!-- æµ‹è¯•1ï¼šåŸºç¡€å…³é—­æŒ‰é’®æµ‹è¯• -->
        <div class="test-section">
            <div class="test-title">æµ‹è¯• 1: åŸºç¡€å…³é—­æŒ‰é’®</div>
            <div class="test-description">
                ç‚¹å‡»æŒ‰é’®æ‰“å¼€æŠ½å±‰ï¼Œç„¶åå°è¯•ç‚¹å‡»å³ä¸Šè§’çš„ âœ• æŒ‰é’®å…³é—­æŠ½å±‰
            </div>
            <button class="btn" onclick="openTest1()">æ‰“å¼€æµ‹è¯•æŠ½å±‰ 1</button>
            <div id="test1-status"></div>
        </div>
        
        <!-- æµ‹è¯•2ï¼šå¤šä¸ªä½ç½®æµ‹è¯• -->
        <div class="test-section">
            <div class="test-title">æµ‹è¯• 2: ä¸åŒä½ç½®çš„æŠ½å±‰</div>
            <div class="test-description">
                æµ‹è¯•å·¦ã€å³ã€ä¸Šã€ä¸‹å››ä¸ªä½ç½®çš„æŠ½å±‰å…³é—­æŒ‰é’®æ˜¯å¦éƒ½èƒ½æ­£å¸¸å·¥ä½œ
            </div>
            <button class="btn btn-success" onclick="openTest2('left')">å·¦ä¾§æŠ½å±‰</button>
            <button class="btn btn-success" onclick="openTest2('right')">å³ä¾§æŠ½å±‰</button>
            <button class="btn btn-success" onclick="openTest2('top')">é¡¶éƒ¨æŠ½å±‰</button>
            <button class="btn btn-success" onclick="openTest2('bottom')">åº•éƒ¨æŠ½å±‰</button>
            <div id="test2-status"></div>
        </div>
        
        <!-- æµ‹è¯•3ï¼šå¸¦è¿”å›æŒ‰é’®æµ‹è¯• -->
        <div class="test-section">
            <div class="test-title">æµ‹è¯• 3: å¸¦è¿”å›å’Œå…³é—­æŒ‰é’®</div>
            <div class="test-description">
                æµ‹è¯•åŒæ—¶æœ‰è¿”å›æŒ‰é’®å’Œå…³é—­æŒ‰é’®æ—¶ï¼Œä¸¤ä¸ªæŒ‰é’®æ˜¯å¦éƒ½èƒ½æ­£å¸¸å·¥ä½œ
            </div>
            <button class="btn btn-warning" onclick="openTest3()">æ‰“å¼€æµ‹è¯•æŠ½å±‰ 3</button>
            <div id="test3-status"></div>
        </div>
        
        <!-- æµ‹è¯•4ï¼šå…¨å±åˆ‡æ¢æŒ‰é’®æµ‹è¯• -->
        <div class="test-section">
            <div class="test-title">æµ‹è¯• 4: å…¨å±åˆ‡æ¢å’Œå…³é—­æŒ‰é’®</div>
            <div class="test-description">
                æµ‹è¯•å…¨å±åˆ‡æ¢æŒ‰é’®å’Œå…³é—­æŒ‰é’®æ˜¯å¦éƒ½èƒ½æ­£å¸¸å“åº”è§¦æ‘¸äº‹ä»¶
            </div>
            <button class="btn btn-danger" onclick="openTest4()">æ‰“å¼€æµ‹è¯•æŠ½å±‰ 4</button>
            <div id="test4-status"></div>
        </div>
        
        <!-- äº‹ä»¶æ—¥å¿— -->
        <div class="test-section">
            <div class="test-title">ğŸ“Š äº‹ä»¶æ—¥å¿—</div>
            <button class="btn" onclick="clearLog()">æ¸…ç©ºæ—¥å¿—</button>
            <div id="event-log" class="event-log">
                <div class="event-log-item">
                    <span class="timestamp">ç­‰å¾…äº‹ä»¶...</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- æµ‹è¯•æŠ½å±‰ç»„ä»¶ -->
    
    <!-- æµ‹è¯•1æŠ½å±‰ -->
    <ldesign-drawer id="drawer1" placement="right" drawer-title="æµ‹è¯•æŠ½å±‰ 1">
        <div class="drawer-content">
            <div class="close-test-area">
                <h4>âœ‹ å…³é—­æŒ‰é’®æµ‹è¯•åŒºåŸŸ</h4>
                <p class="close-instruction">
                    è¯·ç‚¹å‡»å³ä¸Šè§’çš„ <strong>âœ• å…³é—­æŒ‰é’®</strong>
                </p>
                <p class="close-instruction">
                    å¦‚æœå…³é—­æŒ‰é’®æ— å“åº”ï¼Œè¯´æ˜å­˜åœ¨é—®é¢˜
                </p>
                <p class="close-instruction">
                    æ­£å¸¸æƒ…å†µä¸‹ï¼Œç‚¹å‡»å…³é—­æŒ‰é’®åº”è¯¥ç«‹å³å…³é—­æŠ½å±‰
                </p>
            </div>
            <h3>æµ‹è¯•å†…å®¹</h3>
            <p>è¿™æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•å…³é—­æŒ‰é’®çš„æŠ½å±‰ã€‚</p>
            <p>åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šï¼Œå…³é—­æŒ‰é’®åº”è¯¥ï¼š</p>
            <ul>
                <li>è§¦æ‘¸åŒºåŸŸè¶³å¤Ÿå¤§ï¼ˆè‡³å°‘ 44x44pxï¼‰</li>
                <li>å“åº”è§¦æ‘¸äº‹ä»¶ï¼ˆtouchendï¼‰</li>
                <li>é˜²æ­¢äº‹ä»¶ç©¿é€</li>
                <li>æœ‰è§†è§‰åé¦ˆ</li>
            </ul>
        </div>
    </ldesign-drawer>
    
    <!-- æµ‹è¯•2æŠ½å±‰ - å·¦ -->
    <ldesign-drawer id="drawer2-left" placement="left" drawer-title="å·¦ä¾§æŠ½å±‰">
        <div class="drawer-content">
            <div class="close-test-area">
                <h4>å·¦ä¾§æŠ½å±‰æµ‹è¯•</h4>
                <p class="close-instruction">ç‚¹å‡»å³ä¸Šè§’çš„ âœ• å…³é—­æŒ‰é’®</p>
            </div>
        </div>
    </ldesign-drawer>
    
    <!-- æµ‹è¯•2æŠ½å±‰ - å³ -->
    <ldesign-drawer id="drawer2-right" placement="right" drawer-title="å³ä¾§æŠ½å±‰">
        <div class="drawer-content">
            <div class="close-test-area">
                <h4>å³ä¾§æŠ½å±‰æµ‹è¯•</h4>
                <p class="close-instruction">ç‚¹å‡»å³ä¸Šè§’çš„ âœ• å…³é—­æŒ‰é’®</p>
            </div>
        </div>
    </ldesign-drawer>
    
    <!-- æµ‹è¯•2æŠ½å±‰ - ä¸Š -->
    <ldesign-drawer id="drawer2-top" placement="top" drawer-title="é¡¶éƒ¨æŠ½å±‰">
        <div class="drawer-content">
            <div class="close-test-area">
                <h4>é¡¶éƒ¨æŠ½å±‰æµ‹è¯•</h4>
                <p class="close-instruction">ç‚¹å‡»å³ä¸Šè§’çš„ âœ• å…³é—­æŒ‰é’®</p>
            </div>
        </div>
    </ldesign-drawer>
    
    <!-- æµ‹è¯•2æŠ½å±‰ - ä¸‹ -->
    <ldesign-drawer id="drawer2-bottom" placement="bottom" drawer-title="åº•éƒ¨æŠ½å±‰">
        <div class="drawer-content">
            <div class="close-test-area">
                <h4>åº•éƒ¨æŠ½å±‰æµ‹è¯•</h4>
                <p class="close-instruction">ç‚¹å‡»å³ä¸Šè§’çš„ âœ• å…³é—­æŒ‰é’®</p>
            </div>
        </div>
    </ldesign-drawer>
    
    <!-- æµ‹è¯•3æŠ½å±‰ -->
    <ldesign-drawer id="drawer3" placement="right" drawer-title="å¸¦è¿”å›æŒ‰é’®" show-back>
        <div class="drawer-content">
            <div class="close-test-area">
                <h4>å¤šæŒ‰é’®æµ‹è¯•</h4>
                <p class="close-instruction">æµ‹è¯•å·¦ä¾§çš„ â† è¿”å›æŒ‰é’®</p>
                <p class="close-instruction">æµ‹è¯•å³ä¾§çš„ âœ• å…³é—­æŒ‰é’®</p>
            </div>
        </div>
    </ldesign-drawer>
    
    <!-- æµ‹è¯•4æŠ½å±‰ -->
    <ldesign-drawer id="drawer4" placement="right" drawer-title="å…¨å±åˆ‡æ¢æµ‹è¯•" fullscreenable>
        <div class="drawer-content">
            <div class="close-test-area">
                <h4>å…¨å±åˆ‡æ¢å’Œå…³é—­</h4>
                <p class="close-instruction">æµ‹è¯•å…¨å±åˆ‡æ¢æŒ‰é’®</p>
                <p class="close-instruction">æµ‹è¯•å…³é—­æŒ‰é’®</p>
            </div>
        </div>
    </ldesign-drawer>
    
    <script type="module">
        // æ—¥å¿—è®°å½•
        function logEvent(message, type = 'info') {
            const log = document.getElementById('event-log');
            const now = new Date();
            const timestamp = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}:${now.getSeconds().toString().padStart(2, '0')}.${now.getMilliseconds().toString().padStart(3, '0')}`;
            
            const item = document.createElement('div');
            item.className = 'event-log-item';
            item.innerHTML = `<span class="timestamp">${timestamp}</span><span style="color: ${type === 'success' ? '#28a745' : type === 'error' ? '#dc3545' : '#333'}">${message}</span>`;
            
            log.appendChild(item);
            log.scrollTop = log.scrollHeight;
        }
        
        function showStatus(containerId, message, type = 'info') {
            const container = document.getElementById(containerId);
            container.innerHTML = `<div class="status ${type}">${message}</div>`;
        }
        
        window.clearLog = function() {
            const log = document.getElementById('event-log');
            log.innerHTML = '<div class="event-log-item"><span class="timestamp">æ—¥å¿—å·²æ¸…ç©º</span></div>';
        };
        
        // æµ‹è¯•1
        window.openTest1 = function() {
            const drawer = document.getElementById('drawer1');
            drawer.open();
            logEvent('æµ‹è¯•1: æ‰“å¼€æŠ½å±‰ 1');
            showStatus('test1-status', 'âœ… æŠ½å±‰å·²æ‰“å¼€ï¼Œè¯·ç‚¹å‡»å³ä¸Šè§’å…³é—­æŒ‰é’®', 'success');
            checkDrawerOverflow('drawer1');
        };
        
        // æµ‹è¯•2
        window.openTest2 = function(placement) {
            const drawer = document.getElementById(`drawer2-${placement}`);
            drawer.open();
            logEvent(`æµ‹è¯•2: æ‰“å¼€ ${placement} æŠ½å±‰`);
            showStatus('test2-status', `âœ… ${placement} æŠ½å±‰å·²æ‰“å¼€ï¼Œè¯·ç‚¹å‡»å…³é—­æŒ‰é’®`, 'success');
            checkDrawerOverflow(`drawer2-${placement}`);
        };
        
        // æµ‹è¯•3
        window.openTest3 = function() {
            const drawer = document.getElementById('drawer3');
            drawer.open();
            logEvent('æµ‹è¯•3: æ‰“å¼€å¸¦è¿”å›æŒ‰é’®çš„æŠ½å±‰');
            showStatus('test3-status', 'âœ… æŠ½å±‰å·²æ‰“å¼€ï¼Œè¯·åˆ†åˆ«æµ‹è¯•è¿”å›å’Œå…³é—­æŒ‰é’®', 'success');
            checkDrawerOverflow('drawer3');
        };
        
        // æµ‹è¯•4
        window.openTest4 = function() {
            const drawer = document.getElementById('drawer4');
            drawer.open();
            logEvent('æµ‹è¯•4: æ‰“å¼€å…¨å±åˆ‡æ¢æŠ½å±‰');
            showStatus('test4-status', 'âœ… æŠ½å±‰å·²æ‰“å¼€ï¼Œè¯·æµ‹è¯•å…¨å±åˆ‡æ¢å’Œå…³é—­æŒ‰é’®', 'success');
            checkDrawerOverflow('drawer4');
        };
        
        // ç›‘å¬æ‰€æœ‰æŠ½å±‰äº‹ä»¶
        document.addEventListener('DOMContentLoaded', () => {
            const drawers = document.querySelectorAll('ldesign-drawer');
            
            drawers.forEach((drawer, index) => {
                drawer.addEventListener('drawerOpen', () => {
                    logEvent(`æŠ½å±‰ ${drawer.id} å·²æ‰“å¼€`, 'success');
                });
                
                drawer.addEventListener('drawerClose', (e) => {
                    const reason = e.detail?.reason || 'unknown';
                    logEvent(`æŠ½å±‰ ${drawer.id} å·²å…³é—­ (åŸå› : ${reason})`, 'success');
                    
                    // æ ¹æ®å…³é—­åŸå› æ›´æ–°çŠ¶æ€
                    if (reason === 'button') {
                        const testId = drawer.id.replace('drawer', 'test').replace('-left', '').replace('-right', '').replace('-top', '').replace('-bottom', '');
                        const statusId = testId + '-status';
                        if (document.getElementById(statusId)) {
                            showStatus(statusId, 'âœ… æˆåŠŸï¼å…³é—­æŒ‰é’®å·¥ä½œæ­£å¸¸', 'success');
                        }
                    }
                });
                
                drawer.addEventListener('drawerBeforeClose', (e) => {
                    logEvent(`æŠ½å±‰ ${drawer.id} å‡†å¤‡å…³é—­...`);
                });
            });
            
            logEvent('é¡µé¢åŠ è½½å®Œæˆï¼Œæµ‹è¯•å‡†å¤‡å°±ç»ª', 'success');
        });
        
        // æ£€æµ‹è®¾å¤‡ä¿¡æ¯
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        const isTouch = 'ontouchstart' in window;
        
        // æ›´æ–°è®¾å¤‡ä¿¡æ¯æ˜¾ç¤º
        function updateDeviceInfo() {
            document.getElementById('screen-width').textContent = window.innerWidth;
            document.getElementById('screen-height').textContent = window.innerHeight;
            document.getElementById('device-type').textContent = isMobile ? 'ç§»åŠ¨è®¾å¤‡' : 'æ¡Œé¢è®¾å¤‡';
        }
        updateDeviceInfo();
        window.addEventListener('resize', updateDeviceInfo);
        
        logEvent(`è®¾å¤‡ç±»å‹: ${isMobile ? 'ç§»åŠ¨è®¾å¤‡' : 'æ¡Œé¢è®¾å¤‡'}, è§¦æ‘¸æ”¯æŒ: ${isTouch ? 'æ˜¯' : 'å¦'}`);
        logEvent(`å±å¹•å°ºå¯¸: ${window.innerWidth} x ${window.innerHeight}`);
        logEvent(`User Agent: ${navigator.userAgent.substring(0, 60)}...`);
        
        // æ£€æµ‹æŠ½å±‰æ˜¯å¦è¶…å‡ºå±å¹•
        function checkDrawerOverflow(drawerId) {
            setTimeout(() => {
                const drawer = document.getElementById(drawerId);
                if (!drawer) return;
                
                const wrapper = drawer.shadowRoot?.querySelector('.drawer-wrapper');
                if (!wrapper) return;
                
                const rect = wrapper.getBoundingClientRect();
                const viewportWidth = window.innerWidth;
                const viewportHeight = window.innerHeight;
                
                let isOverflow = false;
                let message = '';
                
                if (rect.right > viewportWidth) {
                    isOverflow = true;
                    message = `âš ï¸ è­¦å‘Š: æŠ½å±‰è¶…å‡ºå³ä¾§å±å¹• ${(rect.right - viewportWidth).toFixed(0)}px`;
                } else if (rect.left < 0) {
                    isOverflow = true;
                    message = `âš ï¸ è­¦å‘Š: æŠ½å±‰è¶…å‡ºå·¦ä¾§å±å¹• ${Math.abs(rect.left).toFixed(0)}px`;
                } else if (rect.bottom > viewportHeight) {
                    isOverflow = true;
                    message = `âš ï¸ è­¦å‘Š: æŠ½å±‰è¶…å‡ºåº•éƒ¨å±å¹• ${(rect.bottom - viewportHeight).toFixed(0)}px`;
                } else if (rect.top < 0) {
                    isOverflow = true;
                    message = `âš ï¸ è­¦å‘Š: æŠ½å±‰è¶…å‡ºé¡¶éƒ¨å±å¹• ${Math.abs(rect.top).toFixed(0)}px`;
                } else {
                    message = `âœ… æŠ½å±‰å°ºå¯¸æ­£å¸¸: å®½=${rect.width.toFixed(0)}px, é«˜=${rect.height.toFixed(0)}px`;
                }
                
                logEvent(message, isOverflow ? 'error' : 'success');
            }, 500);
        }
    </script>
</body>
</html>
