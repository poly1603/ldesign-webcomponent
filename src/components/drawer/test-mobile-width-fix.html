<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>ç§»åŠ¨ç«¯æŠ½å±‰å®½åº¦ä¿®å¤éªŒè¯</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
            overflow-x: hidden; /* ç¡®ä¿é¡µé¢æœ¬èº«ä¸æ»šåŠ¨ */
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            font-size: 22px;
            margin-bottom: 10px;
            color: #333;
            text-align: center;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 20px;
            font-size: 13px;
            line-height: 1.5;
        }
        
        .test-section {
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .test-section h3 {
            font-size: 16px;
            margin-bottom: 10px;
            color: #555;
        }
        
        .test-section p {
            font-size: 13px;
            color: #666;
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .btn {
            width: 100%;
            padding: 14px;
            margin: 8px 0;
            font-size: 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 600;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        .btn:active {
            transform: scale(0.98);
        }
        
        .btn-secondary {
            background: #6c757d;
            box-shadow: 0 4px 12px rgba(108, 117, 125, 0.3);
        }
        
        .btn-danger {
            background: #dc3545;
            box-shadow: 0 4px 12px rgba(220, 53, 69, 0.3);
        }
        
        .info-box {
            background: #e7f3ff;
            border-left: 4px solid #2196F3;
            padding: 12px;
            margin: 15px 0;
            border-radius: 4px;
            font-size: 13px;
            line-height: 1.6;
        }
        
        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 12px;
            margin: 15px 0;
            border-radius: 4px;
            font-size: 13px;
            line-height: 1.6;
        }
        
        .success-box {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 12px;
            margin: 15px 0;
            border-radius: 4px;
            font-size: 13px;
            line-height: 1.6;
        }
        
        .check-list {
            list-style: none;
            padding: 0;
            margin: 15px 0;
        }
        
        .check-list li {
            padding: 8px 0 8px 30px;
            position: relative;
            font-size: 13px;
            line-height: 1.5;
        }
        
        .check-list li:before {
            content: "âœ“";
            position: absolute;
            left: 8px;
            color: #28a745;
            font-weight: bold;
            font-size: 16px;
        }
        
        .drawer-content-sample {
            padding: 20px;
        }
        
        .drawer-content-sample h2 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #333;
        }
        
        .drawer-content-sample p {
            font-size: 14px;
            line-height: 1.8;
            color: #666;
            margin-bottom: 12px;
        }
        
        .drawer-content-sample .highlight {
            background: #fff3cd;
            padding: 12px;
            border-radius: 6px;
            margin: 15px 0;
            font-size: 13px;
            line-height: 1.6;
        }
        
        .viewport-info {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 6px;
            margin: 15px 0;
            font-size: 12px;
            font-family: monospace;
            color: #495057;
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }
            
            h1 {
                font-size: 20px;
            }
            
            .test-section {
                padding: 12px;
            }
            
            .btn {
                padding: 12px;
                font-size: 14px;
            }
        }
    </style>
    <script type="module" src="../../../dist/ldesign.js"></script>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ ç§»åŠ¨ç«¯æŠ½å±‰å®½åº¦ä¿®å¤éªŒè¯</h1>
        <p class="subtitle">
            éªŒè¯æŠ½å±‰ç»„ä»¶åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šçš„å®½åº¦ä¸ä¼šè¶…å‡ºå±å¹•<br>
            è¯·åœ¨çœŸå®ç§»åŠ¨è®¾å¤‡æˆ–æµè§ˆå™¨æ¨¡æ‹Ÿå™¨ä¸Šæµ‹è¯•
        </p>
        
        <div class="info-box">
            <strong>ğŸ“± å½“å‰è§†å£ä¿¡æ¯ï¼š</strong><br>
            <div class="viewport-info" id="viewport-info">
                å®½åº¦: <span id="vw-width"></span>px<br>
                é«˜åº¦: <span id="vw-height"></span>px<br>
                è®¾å¤‡åƒç´ æ¯”: <span id="vw-dpr"></span><br>
                User Agent: <span id="vw-ua"></span>
            </div>
        </div>
        
        <div class="test-section">
            <h3>æµ‹è¯• 1: å·¦ä¾§æŠ½å±‰ (85% å®½åº¦)</h3>
            <p>é¢„æœŸï¼šæŠ½å±‰å®½åº¦ä¸è¶…å‡ºå±å¹•ï¼Œå·¦å³ä¿ç•™é€‚å½“ç©ºé—´</p>
            <button class="btn" onclick="openDrawer('left', '85%')">
                æ‰“å¼€å·¦ä¾§æŠ½å±‰ (85%)
            </button>
        </div>
        
        <div class="test-section">
            <h3>æµ‹è¯• 2: å³ä¾§æŠ½å±‰ (400px å›ºå®šå®½åº¦)</h3>
            <p>é¢„æœŸï¼šåœ¨å°å±å¹•ä¸Šå®½åº¦è¢«é™åˆ¶åœ¨ 100vw å†…</p>
            <button class="btn" onclick="openDrawer('right', '400px')">
                æ‰“å¼€å³ä¾§æŠ½å±‰ (400px)
            </button>
        </div>
        
        <div class="test-section">
            <h3>æµ‹è¯• 3: å³ä¾§æŠ½å±‰ (90% å®½åº¦)</h3>
            <p>é¢„æœŸï¼šå æ®å±å¹• 90% å®½åº¦ï¼Œä½†ä¸è¶…å‡º</p>
            <button class="btn" onclick="openDrawer('right', '90%')">
                æ‰“å¼€å³ä¾§æŠ½å±‰ (90%)
            </button>
        </div>
        
        <div class="test-section">
            <h3>æµ‹è¯• 4: åº•éƒ¨æŠ½å±‰ (60% é«˜åº¦)</h3>
            <p>é¢„æœŸï¼šå æ®å±å¹• 60% é«˜åº¦</p>
            <button class="btn btn-secondary" onclick="openDrawer('bottom', '60%')">
                æ‰“å¼€åº•éƒ¨æŠ½å±‰ (60%)
            </button>
        </div>
        
        <div class="test-section">
            <h3>æµ‹è¯• 5: åº•éƒ¨æŠ½å±‰ (80% é«˜åº¦)</h3>
            <p>é¢„æœŸï¼šå æ®å±å¹• 80% é«˜åº¦</p>
            <button class="btn btn-secondary" onclick="openDrawer('bottom', '80%')">
                æ‰“å¼€åº•éƒ¨æŠ½å±‰ (80%)
            </button>
        </div>
        
        <div class="success-box">
            <strong>âœ… éªŒè¯æ£€æŸ¥æ¸…å•ï¼š</strong>
            <ul class="check-list">
                <li>æŠ½å±‰å®½åº¦/é«˜åº¦ä¸è¶…å‡ºå±å¹•è¾¹ç•Œ</li>
                <li>æ— æ°´å¹³æˆ–å‚ç›´æ»šåŠ¨æ¡å‡ºç°</li>
                <li>å…³é—­æŒ‰é’®å®Œå…¨å¯è§ä¸”å¯ç‚¹å‡»</li>
                <li>å†…å®¹åŒºåŸŸæ­£å¸¸æ»šåŠ¨</li>
                <li>åŠ¨ç”»æµç•…ï¼Œæ— å¡é¡¿</li>
                <li>é®ç½©å±‚æ­£ç¡®æ˜¾ç¤º</li>
                <li>å¯ä»¥é€šè¿‡æ»‘åŠ¨å…³é—­</li>
                <li>ç‚¹å‡»é®ç½©å¯ä»¥å…³é—­</li>
            </ul>
        </div>
        
        <div class="warning-box">
            <strong>âš ï¸ å¦‚æœå‘ç°é—®é¢˜ï¼š</strong><br>
            1. æ£€æŸ¥é¡µé¢æ˜¯å¦æœ‰æ°´å¹³æ»šåŠ¨æ¡<br>
            2. æŠ½å±‰æ˜¯å¦è¶…å‡ºå±å¹•å³è¾¹æˆ–åº•éƒ¨<br>
            3. å…³é—­æŒ‰é’®æ˜¯å¦è¢«æˆªæ–­<br>
            4. åœ¨å¼€å‘è€…å·¥å…·ä¸­æ£€æŸ¥ .drawer-wrapper çš„è®¡ç®—æ ·å¼
        </div>
        
        <button class="btn btn-danger" onclick="closeAllDrawers()">
            ğŸ”’ å…³é—­æ‰€æœ‰æŠ½å±‰
        </button>
    </div>
    
    <!-- å·¦ä¾§æŠ½å±‰ -->
    <ldesign-drawer 
        id="drawer-left"
        placement="left" 
        size="85%"
        drawer-title="å·¦ä¾§æŠ½å±‰ (85%)"
        closable="true"
        mask-closable="true"
        swipe-to-close="true">
        <div class="drawer-content-sample">
            <h2>ğŸ“ å®½åº¦æµ‹è¯•</h2>
            <p>è¿™æ˜¯ä¸€ä¸ªå·¦ä¾§æŠ½å±‰ï¼Œè®¾ç½®å®½åº¦ä¸º 85%ã€‚</p>
            <p>åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šï¼Œåº”è¯¥ï¼š</p>
            <div class="highlight">
                â€¢ å®½åº¦ä¸è¶…è¿‡å±å¹•å®½åº¦ (100vw)<br>
                â€¢ å·¦å³ä¿ç•™é€‚å½“ç©ºé—´<br>
                â€¢ å…³é—­æŒ‰é’®å®Œå…¨å¯è§<br>
                â€¢ å†…å®¹å¯æ­£å¸¸æ»šåŠ¨
            </div>
            <p>è¯·æ£€æŸ¥æŠ½å±‰æ˜¯å¦å®Œå…¨åœ¨å±å¹•å†…ï¼Œæ²¡æœ‰è¶…å‡ºå³è¾¹ç•Œã€‚</p>
            <p>æ‚¨å¯ä»¥å°è¯•å‘å·¦æ»‘åŠ¨æ¥å…³é—­æŠ½å±‰ã€‚</p>
        </div>
    </ldesign-drawer>
    
    <!-- å³ä¾§æŠ½å±‰ (400px) -->
    <ldesign-drawer 
        id="drawer-right-400"
        placement="right" 
        size="400px"
        drawer-title="å³ä¾§æŠ½å±‰ (400px)"
        closable="true"
        mask-closable="true"
        swipe-to-close="true">
        <div class="drawer-content-sample">
            <h2>ğŸ“± å›ºå®šå®½åº¦æµ‹è¯•</h2>
            <p>è¿™æ˜¯ä¸€ä¸ªå³ä¾§æŠ½å±‰ï¼Œè®¾ç½®å›ºå®šå®½åº¦ä¸º 400pxã€‚</p>
            <p>åœ¨å°å±å¹•è®¾å¤‡ä¸Šï¼ˆå®½åº¦ < 400pxï¼‰ï¼š</p>
            <div class="highlight">
                â€¢ å®½åº¦åº”è¢«é™åˆ¶ä¸ºå±å¹•å®½åº¦<br>
                â€¢ max-width: 100vw ç”Ÿæ•ˆ<br>
                â€¢ ä¸ä¼šè¶…å‡ºå±å¹•å·¦è¾¹ç•Œ<br>
                â€¢ å…³é—­æŒ‰é’®åœ¨å±å¹•å†…
            </div>
            <p>å¦‚æœæ‚¨çš„è®¾å¤‡å®½åº¦å°äº 400pxï¼ŒæŠ½å±‰åº”è¯¥è‡ªåŠ¨é€‚é…åˆ°å±å¹•å®½åº¦ã€‚</p>
        </div>
    </ldesign-drawer>
    
    <!-- å³ä¾§æŠ½å±‰ (90%) -->
    <ldesign-drawer 
        id="drawer-right-90"
        placement="right" 
        size="90%"
        drawer-title="å³ä¾§æŠ½å±‰ (90%)"
        closable="true"
        mask-closable="true"
        swipe-to-close="true">
        <div class="drawer-content-sample">
            <h2>ğŸ“ å¤§å®½åº¦æµ‹è¯•</h2>
            <p>è¿™æ˜¯ä¸€ä¸ªå³ä¾§æŠ½å±‰ï¼Œè®¾ç½®å®½åº¦ä¸º 90%ã€‚</p>
            <p>åº”è¯¥å æ®å±å¹•çš„ 90% å®½åº¦ï¼š</p>
            <div class="highlight">
                â€¢ å·¦ä¾§ä¿ç•™ 10% ç©ºé—´<br>
                â€¢ å³è¾¹ç•Œä¸å±å¹•å¯¹é½<br>
                â€¢ ä¸è¶…å‡ºå±å¹•<br>
                â€¢ å†…å®¹å®Œæ•´å¯è§
            </div>
            <p>è¿™æ˜¯ä¸€ä¸ªè¾ƒå¤§çš„æŠ½å±‰ï¼Œç”¨äºæµ‹è¯•é«˜ç™¾åˆ†æ¯”å®½åº¦ä¸‹çš„è¡¨ç°ã€‚</p>
        </div>
    </ldesign-drawer>
    
    <!-- åº•éƒ¨æŠ½å±‰ (60%) -->
    <ldesign-drawer 
        id="drawer-bottom-60"
        placement="bottom" 
        size="60%"
        drawer-title="åº•éƒ¨æŠ½å±‰ (60%)"
        closable="true"
        mask-closable="true"
        swipe-to-close="true">
        <div class="drawer-content-sample">
            <h2>ğŸ“ é«˜åº¦æµ‹è¯• (60%)</h2>
            <p>è¿™æ˜¯ä¸€ä¸ªåº•éƒ¨æŠ½å±‰ï¼Œè®¾ç½®é«˜åº¦ä¸º 60%ã€‚</p>
            <div class="highlight">
                â€¢ é«˜åº¦å å±å¹• 60%<br>
                â€¢ é¡¶éƒ¨ä¿ç•™ 40% ç©ºé—´<br>
                â€¢ ä¸è¶…å‡ºå±å¹•åº•éƒ¨<br>
                â€¢ æ”¯æŒå‘ä¸‹æ»‘åŠ¨å…³é—­
            </div>
            <p>è¯·æ£€æŸ¥æŠ½å±‰é¡¶éƒ¨æ˜¯å¦ç•™æœ‰è¶³å¤Ÿç©ºé—´ï¼Œä»¥åŠåº•éƒ¨æ˜¯å¦ä¸å±å¹•å¯¹é½ã€‚</p>
        </div>
    </ldesign-drawer>
    
    <!-- åº•éƒ¨æŠ½å±‰ (80%) -->
    <ldesign-drawer 
        id="drawer-bottom-80"
        placement="bottom" 
        size="80%"
        drawer-title="åº•éƒ¨æŠ½å±‰ (80%)"
        closable="true"
        mask-closable="true"
        swipe-to-close="true">
        <div class="drawer-content-sample">
            <h2>ğŸ“ é«˜åº¦æµ‹è¯• (80%)</h2>
            <p>è¿™æ˜¯ä¸€ä¸ªåº•éƒ¨æŠ½å±‰ï¼Œè®¾ç½®é«˜åº¦ä¸º 80%ã€‚</p>
            <div class="highlight">
                â€¢ é«˜åº¦å å±å¹• 80%<br>
                â€¢ é¡¶éƒ¨ä¿ç•™ 20% ç©ºé—´<br>
                â€¢ ä¸è¶…å‡ºå±å¹•åº•éƒ¨<br>
                â€¢ max-height: 100vh ç”Ÿæ•ˆ
            </div>
            <p>è¿™æ˜¯ä¸€ä¸ªè¾ƒé«˜çš„åº•éƒ¨æŠ½å±‰ï¼Œç”¨äºæµ‹è¯•å¤§é«˜åº¦ä¸‹çš„è¡¨ç°ã€‚</p>
            <p>å†…å®¹åŒºåŸŸåº”è¯¥å¯ä»¥æ­£å¸¸æ»šåŠ¨ï¼Œä¸ä¼šå½±å“é¡µé¢æ»šåŠ¨ã€‚</p>
        </div>
    </ldesign-drawer>
    
    <script>
        // æ›´æ–°è§†å£ä¿¡æ¯
        function updateViewportInfo() {
            document.getElementById('vw-width').textContent = window.innerWidth;
            document.getElementById('vw-height').textContent = window.innerHeight;
            document.getElementById('vw-dpr').textContent = window.devicePixelRatio;
            document.getElementById('vw-ua').textContent = navigator.userAgent.substring(0, 80) + '...';
        }
        
        // æ‰“å¼€æŒ‡å®šæŠ½å±‰
        async function openDrawer(placement, size) {
            let drawerId;
            
            // æ ¹æ®é…ç½®ç¡®å®šæŠ½å±‰ ID
            if (placement === 'left') {
                drawerId = 'drawer-left';
            } else if (placement === 'right') {
                drawerId = size === '400px' ? 'drawer-right-400' : 'drawer-right-90';
            } else if (placement === 'bottom') {
                drawerId = size === '60%' ? 'drawer-bottom-60' : 'drawer-bottom-80';
            }
            
            const drawer = document.getElementById(drawerId);
            if (drawer) {
                await drawer.open();
                
                // æ‰“å¼€åæ£€æŸ¥æ ·å¼
                setTimeout(() => {
                    const wrapper = drawer.shadowRoot.querySelector('.drawer-wrapper');
                    if (wrapper) {
                        const computedStyle = window.getComputedStyle(wrapper);
                        const actualWidth = wrapper.offsetWidth;
                        const actualHeight = wrapper.offsetHeight;
                        
                        console.log(`[Drawer ${placement}] Computed Style:`, {
                            width: computedStyle.width,
                            maxWidth: computedStyle.maxWidth,
                            actualWidth: actualWidth + 'px',
                            viewportWidth: window.innerWidth + 'px',
                            exceeds: actualWidth > window.innerWidth,
                            height: computedStyle.height,
                            maxHeight: computedStyle.maxHeight,
                            actualHeight: actualHeight + 'px',
                            viewportHeight: window.innerHeight + 'px'
                        });
                        
                        // æ£€æŸ¥æ˜¯å¦è¶…å‡º
                        if (placement === 'left' || placement === 'right') {
                            if (actualWidth > window.innerWidth) {
                                console.error('âŒ å®½åº¦è¶…å‡ºå±å¹•ï¼', {
                                    actual: actualWidth,
                                    viewport: window.innerWidth,
                                    exceeds: actualWidth - window.innerWidth
                                });
                                alert(`âš ï¸ æ£€æµ‹åˆ°é—®é¢˜ï¼\næŠ½å±‰å®½åº¦ (${actualWidth}px) è¶…å‡ºå±å¹•å®½åº¦ (${window.innerWidth}px)`);
                            } else {
                                console.log('âœ… å®½åº¦æ­£å¸¸ï¼Œæœªè¶…å‡ºå±å¹•');
                            }
                        } else {
                            if (actualHeight > window.innerHeight) {
                                console.error('âŒ é«˜åº¦è¶…å‡ºå±å¹•ï¼', {
                                    actual: actualHeight,
                                    viewport: window.innerHeight,
                                    exceeds: actualHeight - window.innerHeight
                                });
                                alert(`âš ï¸ æ£€æµ‹åˆ°é—®é¢˜ï¼\næŠ½å±‰é«˜åº¦ (${actualHeight}px) è¶…å‡ºå±å¹•é«˜åº¦ (${window.innerHeight}px)`);
                            } else {
                                console.log('âœ… é«˜åº¦æ­£å¸¸ï¼Œæœªè¶…å‡ºå±å¹•');
                            }
                        }
                    }
                }, 500);
            }
        }
        
        // å…³é—­æ‰€æœ‰æŠ½å±‰
        async function closeAllDrawers() {
            const drawers = document.querySelectorAll('ldesign-drawer');
            for (const drawer of drawers) {
                await drawer.close();
            }
        }
        
        // åˆå§‹åŒ–
        updateViewportInfo();
        
        // ç›‘å¬çª—å£å¤§å°å˜åŒ–
        window.addEventListener('resize', updateViewportInfo);
        
        // ç›‘å¬æ–¹å‘å˜åŒ–
        window.addEventListener('orientationchange', () => {
            setTimeout(updateViewportInfo, 100);
        });
        
        // é¡µé¢åŠ è½½å®Œæˆæç¤º
        window.addEventListener('load', () => {
            console.log('%cç§»åŠ¨ç«¯æŠ½å±‰å®½åº¦ä¿®å¤éªŒè¯æµ‹è¯•', 'font-size: 16px; font-weight: bold; color: #667eea;');
            console.log('è¯·ç‚¹å‡»æŒ‰é’®æ‰“å¼€ä¸åŒé…ç½®çš„æŠ½å±‰ï¼Œæ£€æŸ¥å®½åº¦æ˜¯å¦è¶…å‡ºå±å¹•ã€‚');
            console.log('æ§åˆ¶å°ä¼šè¾“å‡ºè¯¦ç»†çš„æ ·å¼ä¿¡æ¯ä¾›è°ƒè¯•ä½¿ç”¨ã€‚');
        });
    </script>
</body>
</html>
