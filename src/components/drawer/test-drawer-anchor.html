<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Drawer Anchor Positioning Test</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: #f5f5f5;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    h1 {
      color: #333;
      margin-bottom: 10px;
    }

    .subtitle {
      color: #666;
      margin-bottom: 30px;
    }

    .test-section {
      background: white;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .test-section h2 {
      color: #1890ff;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid #f0f0f0;
    }

    .button-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 15px;
      margin-top: 15px;
    }

    .test-btn {
      padding: 12px 20px;
      border: 1px solid #d9d9d9;
      background: white;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 14px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .test-btn:hover {
      border-color: #1890ff;
      color: #1890ff;
      box-shadow: 0 2px 8px rgba(24, 144, 255, 0.2);
    }

    .test-btn:active {
      transform: scale(0.95);
    }

    /* ç‰¹æ®Šå®šä½çš„æŒ‰é’® */
    .positioned-buttons {
      position: relative;
      height: 300px;
      background: linear-gradient(45deg, #f0f2f5 25%, transparent 25%),
                  linear-gradient(-45deg, #f0f2f5 25%, transparent 25%),
                  linear-gradient(45deg, transparent 75%, #f0f2f5 75%),
                  linear-gradient(-45deg, transparent 75%, #f0f2f5 75%);
      background-size: 20px 20px;
      background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
      border-radius: 8px;
      margin-top: 15px;
    }

    .positioned-btn {
      position: absolute;
      padding: 10px 16px;
      background: #1890ff;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
      transition: all 0.3s;
      white-space: nowrap;
    }

    .positioned-btn:hover {
      background: #40a9ff;
      transform: scale(1.05);
      box-shadow: 0 4px 12px rgba(24, 144, 255, 0.4);
    }

    .positioned-btn.top-left { top: 20px; left: 20px; }
    .positioned-btn.top-right { top: 20px; right: 20px; }
    .positioned-btn.bottom-left { bottom: 20px; left: 20px; }
    .positioned-btn.bottom-right { bottom: 20px; right: 20px; }
    .positioned-btn.center { top: 50%; left: 50%; transform: translate(-50%, -50%); }
    .positioned-btn.center:hover { transform: translate(-50%, -50%) scale(1.05); }

    /* åˆ—è¡¨é¡¹æ ·å¼ */
    .list-container {
      max-height: 400px;
      overflow-y: auto;
      border: 1px solid #e8e8e8;
      border-radius: 4px;
      margin-top: 15px;
    }

    .list-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 16px;
      border-bottom: 1px solid #f0f0f0;
      transition: background 0.3s;
    }

    .list-item:hover {
      background: #f5f5f5;
    }

    .list-item:last-child {
      border-bottom: none;
    }

    .item-info {
      flex: 1;
    }

    .item-title {
      font-weight: 500;
      color: #333;
      margin-bottom: 4px;
    }

    .item-desc {
      font-size: 12px;
      color: #999;
    }

    .item-action {
      padding: 6px 12px;
      background: #52c41a;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
    }

    .item-action:hover {
      background: #73d13d;
    }

    /* æŠ½å±‰å†…å®¹æ ·å¼ */
    .drawer-demo-content {
      padding: 20px;
    }

    .drawer-demo-content h3 {
      margin-bottom: 15px;
      color: #333;
    }

    .drawer-demo-content p {
      color: #666;
      line-height: 1.6;
      margin-bottom: 10px;
    }

    .drawer-demo-form {
      margin-top: 20px;
    }

    .form-group {
      margin-bottom: 15px;
    }

    .form-group label {
      display: block;
      margin-bottom: 5px;
      color: #333;
      font-size: 14px;
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid #d9d9d9;
      border-radius: 4px;
      font-size: 14px;
    }

    .form-group textarea {
      resize: vertical;
      min-height: 80px;
    }

    /* å“åº”å¼ */
    @media (max-width: 768px) {
      .button-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
  
  <!-- å¼•å…¥ç¼–è¯‘åçš„ Web Component -->
  <script type="module" src="../../build/ldesign.esm.js"></script>
  <link rel="stylesheet" href="../../build/ldesign.css">
</head>
<body>
  <div class="container">
    <h1>ğŸ¯ Drawer Anchor Positioning Test</h1>
    <p class="subtitle">æµ‹è¯•æŠ½å±‰ç»„ä»¶çš„é”šç‚¹å®šä½åŠŸèƒ½</p>

    <!-- å…ƒç´ é”šç‚¹æ¨¡å¼æµ‹è¯• -->
    <div class="test-section">
      <h2>ğŸ“ å…ƒç´ é”šç‚¹æ¨¡å¼</h2>
      <p>ç‚¹å‡»æŒ‰é’®ï¼ŒæŠ½å±‰ä¼šä»æŒ‰é’®ä½ç½®å¼¹å‡º</p>
      
      <div class="button-grid">
        <button class="test-btn" id="anchor-left">
          ä»å·¦ä¾§å¼¹å‡º â†’
        </button>
        <button class="test-btn" id="anchor-right">
          â† ä»å³ä¾§å¼¹å‡º
        </button>
        <button class="test-btn" id="anchor-top">
          ä»é¡¶éƒ¨å¼¹å‡º â†“
        </button>
        <button class="test-btn" id="anchor-bottom">
          â†‘ ä»åº•éƒ¨å¼¹å‡º
        </button>
      </div>

      <div class="positioned-buttons">
        <button class="positioned-btn top-left" id="anchor-tl">å·¦ä¸Šè§’</button>
        <button class="positioned-btn top-right" id="anchor-tr">å³ä¸Šè§’</button>
        <button class="positioned-btn center" id="anchor-center">ä¸­å¿ƒ</button>
        <button class="positioned-btn bottom-left" id="anchor-bl">å·¦ä¸‹è§’</button>
        <button class="positioned-btn bottom-right" id="anchor-br">å³ä¸‹è§’</button>
      </div>
    </div>

    <!-- å…‰æ ‡é”šç‚¹æ¨¡å¼æµ‹è¯• -->
    <div class="test-section">
      <h2>ğŸ–±ï¸ å…‰æ ‡é”šç‚¹æ¨¡å¼</h2>
      <p>ç‚¹å‡»ä¸‹é¢çš„åŒºåŸŸï¼ŒæŠ½å±‰ä¼šä»é¼ æ ‡ç‚¹å‡»ä½ç½®å¼¹å‡º</p>
      
      <div class="positioned-buttons" id="cursor-area">
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: #999;">
          <p>åœ¨æ­¤åŒºåŸŸä»»æ„ä½ç½®ç‚¹å‡»</p>
          <p style="font-size: 12px; margin-top: 5px;">æŠ½å±‰å°†ä»ç‚¹å‡»ä½ç½®å±•å¼€</p>
        </div>
      </div>
    </div>

    <!-- åˆ—è¡¨é¡¹é”šç‚¹æµ‹è¯• -->
    <div class="test-section">
      <h2>ğŸ“‹ åˆ—è¡¨é¡¹é”šç‚¹</h2>
      <p>ç‚¹å‡»åˆ—è¡¨é¡¹çš„æ“ä½œæŒ‰é’®ï¼Œæ˜¾ç¤ºè¯¦æƒ…æŠ½å±‰</p>
      
      <div class="list-container">
        <div class="list-item">
          <div class="item-info">
            <div class="item-title">è®¢å• #001</div>
            <div class="item-desc">2024-01-15 14:30</div>
          </div>
          <button class="item-action anchor-list-btn" data-id="001">æŸ¥çœ‹è¯¦æƒ…</button>
        </div>
        <div class="list-item">
          <div class="item-info">
            <div class="item-title">è®¢å• #002</div>
            <div class="item-desc">2024-01-15 15:45</div>
          </div>
          <button class="item-action anchor-list-btn" data-id="002">æŸ¥çœ‹è¯¦æƒ…</button>
        </div>
        <div class="list-item">
          <div class="item-info">
            <div class="item-title">è®¢å• #003</div>
            <div class="item-desc">2024-01-15 16:20</div>
          </div>
          <button class="item-action anchor-list-btn" data-id="003">æŸ¥çœ‹è¯¦æƒ…</button>
        </div>
        <div class="list-item">
          <div class="item-info">
            <div class="item-title">è®¢å• #004</div>
            <div class="item-desc">2024-01-15 17:10</div>
          </div>
          <button class="item-action anchor-list-btn" data-id="004">æŸ¥çœ‹è¯¦æƒ…</button>
        </div>
        <div class="list-item">
          <div class="item-info">
            <div class="item-title">è®¢å• #005</div>
            <div class="item-desc">2024-01-15 18:00</div>
          </div>
          <button class="item-action anchor-list-btn" data-id="005">æŸ¥çœ‹è¯¦æƒ…</button>
        </div>
      </div>
    </div>

    <!-- å¯¹é½æ–¹å¼æµ‹è¯• -->
    <div class="test-section">
      <h2>âš¡ å¯¹é½æ–¹å¼æµ‹è¯•</h2>
      <p>æµ‹è¯•ä¸åŒçš„å¯¹é½æ–¹å¼</p>
      
      <div class="button-grid">
        <button class="test-btn" id="align-start">
          èµ·å§‹å¯¹é½
        </button>
        <button class="test-btn" id="align-center">
          ä¸­å¿ƒå¯¹é½
        </button>
        <button class="test-btn" id="align-end">
          æœ«å°¾å¯¹é½
        </button>
        <button class="test-btn" id="align-stretch">
          æ‹‰ä¼¸å¯¹é½
        </button>
      </div>
    </div>

    <!-- é…ç½®æµ‹è¯• -->
    <div class="test-section">
      <h2>âš™ï¸ é…ç½®æµ‹è¯•</h2>
      <p>æµ‹è¯•å„ç§é”šç‚¹é…ç½®é€‰é¡¹</p>
      
      <div class="button-grid">
        <button class="test-btn" id="config-flip">
          è‡ªåŠ¨ç¿»è½¬
        </button>
        <button class="test-btn" id="config-constrain">
          è¾¹ç•Œçº¦æŸ
        </button>
        <button class="test-btn" id="config-offset">
          åç§»å®šä½
        </button>
        <button class="test-btn" id="config-partial-mask">
          éƒ¨åˆ†é®ç½©
        </button>
        <button class="test-btn" id="config-follow">
          è·Ÿéšæ»šåŠ¨
        </button>
        <button class="test-btn" id="config-auto-update">
          è‡ªåŠ¨æ›´æ–°ä½ç½®
        </button>
      </div>
    </div>
  </div>

  <!-- Drawer Components -->
  <ldesign-drawer id="anchorDrawer">
    <div class="drawer-demo-content">
      <h3 id="drawer-title">é”šç‚¹æŠ½å±‰</h3>
      <p id="drawer-desc">è¿™æ˜¯ä¸€ä¸ªé”šç‚¹å®šä½çš„æŠ½å±‰ç¤ºä¾‹</p>
      
      <div class="drawer-demo-form">
        <div class="form-group">
          <label>åç§°</label>
          <input type="text" placeholder="è¯·è¾“å…¥åç§°">
        </div>
        <div class="form-group">
          <label>æè¿°</label>
          <textarea placeholder="è¯·è¾“å…¥æè¿°"></textarea>
        </div>
        <div class="form-group">
          <label>ç±»å‹</label>
          <select>
            <option>ç±»å‹ 1</option>
            <option>ç±»å‹ 2</option>
            <option>ç±»å‹ 3</option>
          </select>
        </div>
      </div>
    </div>
  </ldesign-drawer>

  <script>
    // è®°å½•ç‚¹å‡»ä½ç½®ï¼ˆç”¨äºå…‰æ ‡æ¨¡å¼ï¼‰
    document.addEventListener('click', (e) => {
      window.__lastClickPosition = { x: e.clientX, y: e.clientY };
    });

    const drawer = document.getElementById('anchorDrawer');

    // å…ƒç´ é”šç‚¹æ¨¡å¼ - åŸºæœ¬æ–¹å‘
    document.getElementById('anchor-left').addEventListener('click', (e) => {
      e.stopPropagation();
      drawer.anchorMode = 'element';
      drawer.anchorElement = e.target;
      drawer.placement = 'left';
      drawer.drawerTitle = 'ä»å·¦ä¾§å±•å¼€';
      drawer.size = '300px';
      drawer.anchorAlign = 'start';
      drawer.anchorMaskPartial = true;
      drawer.visible = true;
    });

    document.getElementById('anchor-right').addEventListener('click', (e) => {
      e.stopPropagation();
      drawer.anchorMode = 'element';
      drawer.anchorElement = e.target;
      drawer.placement = 'right';
      drawer.drawerTitle = 'ä»å³ä¾§å±•å¼€';
      drawer.size = '300px';
      drawer.anchorAlign = 'start';
      drawer.anchorMaskPartial = true;
      drawer.visible = true;
    });

    document.getElementById('anchor-top').addEventListener('click', (e) => {
      e.stopPropagation();
      drawer.anchorMode = 'element';
      drawer.anchorElement = e.target;
      drawer.placement = 'top';
      drawer.drawerTitle = 'ä»é¡¶éƒ¨å±•å¼€';
      drawer.size = '200px';
      drawer.anchorAlign = 'center';
      drawer.anchorMaskPartial = true;
      drawer.visible = true;
    });

    document.getElementById('anchor-bottom').addEventListener('click', (e) => {
      e.stopPropagation();
      drawer.anchorMode = 'element';
      drawer.anchorElement = e.target;
      drawer.placement = 'bottom';
      drawer.drawerTitle = 'ä»åº•éƒ¨å±•å¼€';
      drawer.size = '200px';
      drawer.anchorAlign = 'center';
      drawer.anchorMaskPartial = true;
      drawer.visible = true;
    });

    // ç‰¹æ®Šä½ç½®æŒ‰é’®
    ['tl', 'tr', 'center', 'bl', 'br'].forEach(pos => {
      document.getElementById(`anchor-${pos}`).addEventListener('click', (e) => {
        e.stopPropagation();
        drawer.anchorMode = 'element';
        drawer.anchorElement = e.target;
        drawer.placement = pos.includes('t') ? 'bottom' : pos.includes('b') ? 'top' : 'right';
        drawer.drawerTitle = `ä½ç½®: ${pos.toUpperCase()}`;
        drawer.size = '250px';
        drawer.anchorAlign = 'center';
        drawer.anchorFlip = true;
        drawer.anchorConstrain = true;
        drawer.anchorMaskPartial = true;
        drawer.visible = true;
      });
    });

    // å…‰æ ‡é”šç‚¹æ¨¡å¼
    document.getElementById('cursor-area').addEventListener('click', (e) => {
      if (e.target.id === 'cursor-area') {
        drawer.anchorMode = 'cursor';
        drawer.placement = 'right';
        drawer.drawerTitle = 'å…‰æ ‡ä½ç½®æŠ½å±‰';
        drawer.size = '280px';
        drawer.anchorMaskPartial = false;
        drawer.visible = true;
        
        document.getElementById('drawer-desc').textContent = 
          `ç‚¹å‡»ä½ç½®: (${e.clientX}, ${e.clientY})`;
      }
    });

    // åˆ—è¡¨é¡¹é”šç‚¹
    document.querySelectorAll('.anchor-list-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        const orderId = e.target.dataset.id;
        drawer.anchorMode = 'element';
        drawer.anchorElement = e.target;
        drawer.placement = 'right';
        drawer.drawerTitle = `è®¢å• #${orderId} è¯¦æƒ…`;
        drawer.size = '350px';
        drawer.anchorAlign = 'start';
        drawer.anchorOffset = 10;
        drawer.anchorMaskPartial = true;
        drawer.anchorFollowScroll = true;
        drawer.visible = true;
        
        document.getElementById('drawer-desc').textContent = 
          `æŸ¥çœ‹è®¢å• #${orderId} çš„è¯¦ç»†ä¿¡æ¯`;
      });
    });

    // å¯¹é½æ–¹å¼æµ‹è¯•
    const alignTests = {
      'align-start': { align: 'start', title: 'èµ·å§‹å¯¹é½' },
      'align-center': { align: 'center', title: 'ä¸­å¿ƒå¯¹é½' },
      'align-end': { align: 'end', title: 'æœ«å°¾å¯¹é½' },
      'align-stretch': { align: 'stretch', title: 'æ‹‰ä¼¸å¯¹é½' }
    };

    Object.keys(alignTests).forEach(id => {
      document.getElementById(id).addEventListener('click', (e) => {
        e.stopPropagation();
        const config = alignTests[id];
        drawer.anchorMode = 'element';
        drawer.anchorElement = e.target;
        drawer.placement = 'bottom';
        drawer.drawerTitle = config.title;
        drawer.size = '200px';
        drawer.anchorAlign = config.align;
        drawer.anchorMaskPartial = true;
        drawer.visible = true;
      });
    });

    // é…ç½®æµ‹è¯•
    document.getElementById('config-flip').addEventListener('click', (e) => {
      e.stopPropagation();
      drawer.anchorMode = 'element';
      drawer.anchorElement = e.target;
      drawer.placement = 'top';
      drawer.drawerTitle = 'è‡ªåŠ¨ç¿»è½¬';
      drawer.size = '250px';
      drawer.anchorFlip = true;
      drawer.anchorMaskPartial = true;
      drawer.visible = true;
      document.getElementById('drawer-desc').textContent = 
        'å½“ç©ºé—´ä¸è¶³æ—¶è‡ªåŠ¨ç¿»è½¬åˆ°å¯¹é¢';
    });

    document.getElementById('config-constrain').addEventListener('click', (e) => {
      e.stopPropagation();
      drawer.anchorMode = 'element';
      drawer.anchorElement = e.target;
      drawer.placement = 'right';
      drawer.drawerTitle = 'è¾¹ç•Œçº¦æŸ';
      drawer.size = '300px';
      drawer.anchorConstrain = true;
      drawer.anchorBoundary = 'viewport';
      drawer.anchorMaskPartial = true;
      drawer.visible = true;
      document.getElementById('drawer-desc').textContent = 
        'æŠ½å±‰ä¼šè¢«çº¦æŸåœ¨è§†å£è¾¹ç•Œå†…';
    });

    document.getElementById('config-offset').addEventListener('click', (e) => {
      e.stopPropagation();
      drawer.anchorMode = 'element';
      drawer.anchorElement = e.target;
      drawer.placement = 'right';
      drawer.drawerTitle = 'åç§»å®šä½';
      drawer.size = '280px';
      drawer.anchorOffset = 20;
      drawer.anchorMaskPartial = true;
      drawer.visible = true;
      document.getElementById('drawer-desc').textContent = 
        'æŠ½å±‰ç›¸å¯¹é”šç‚¹æœ‰ 20px çš„åç§»';
    });

    document.getElementById('config-partial-mask').addEventListener('click', (e) => {
      e.stopPropagation();
      drawer.anchorMode = 'element';
      drawer.anchorElement = e.target;
      drawer.placement = 'bottom';
      drawer.drawerTitle = 'éƒ¨åˆ†é®ç½©';
      drawer.size = '200px';
      drawer.anchorMaskPartial = true;
      drawer.visible = true;
      document.getElementById('drawer-desc').textContent = 
        'é®ç½©åªè¦†ç›–æŠ½å±‰å±•å¼€çš„åŒºåŸŸ';
    });

    document.getElementById('config-follow').addEventListener('click', (e) => {
      e.stopPropagation();
      drawer.anchorMode = 'element';
      drawer.anchorElement = e.target;
      drawer.placement = 'right';
      drawer.drawerTitle = 'è·Ÿéšæ»šåŠ¨';
      drawer.size = '300px';
      drawer.anchorFollowScroll = true;
      drawer.anchorMaskPartial = true;
      drawer.visible = true;
      document.getElementById('drawer-desc').textContent = 
        'æ»šåŠ¨é¡µé¢æ—¶æŠ½å±‰ä¼šè·Ÿéšé”šç‚¹ç§»åŠ¨';
    });

    document.getElementById('config-auto-update').addEventListener('click', (e) => {
      e.stopPropagation();
      drawer.anchorMode = 'element';
      drawer.anchorElement = e.target;
      drawer.placement = 'left';
      drawer.drawerTitle = 'è‡ªåŠ¨æ›´æ–°';
      drawer.size = '300px';
      drawer.anchorAutoUpdate = true;
      drawer.anchorMaskPartial = true;
      drawer.visible = true;
      document.getElementById('drawer-desc').textContent = 
        'é”šç‚¹ä½ç½®å˜åŒ–æ—¶æŠ½å±‰ä¼šè‡ªåŠ¨æ›´æ–°ä½ç½®';
    });
  </script>
</body>
</html>